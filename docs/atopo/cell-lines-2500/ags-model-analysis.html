<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>AGS Model Analysis | Biomarker Atopo Analysis (2500 models per cell line, 8 cell lines)</title>
  <meta name="description" content="Description" />
  <meta name="generator" content="bookdown 0.12 and GitBook 2.6.7" />

  <meta property="og:title" content="AGS Model Analysis | Biomarker Atopo Analysis (2500 models per cell line, 8 cell lines)" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://bblodfon.github.io/gitsbe-model-analysis/" />
  
  <meta property="og:description" content="Description" />
  <meta name="github-repo" content="bblodfon/gitsbe-model-analysis" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="AGS Model Analysis | Biomarker Atopo Analysis (2500 models per cell line, 8 cell lines)" />
  
  <meta name="twitter:description" content="Description" />
  

<meta name="author" content="John Zobolas" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="a498-model-analysis.html">
<link rel="next" href="session-info.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />








<script>
/* ========================================================================
 * Bootstrap: transition.js v3.3.7
 * http://getbootstrap.com/javascript/#transitions
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // CSS TRANSITION SUPPORT (Shoutout: http://www.modernizr.com/)
  // ============================================================

  function transitionEnd() {
    var el = document.createElement('bootstrap')

    var transEndEventNames = {
      WebkitTransition : 'webkitTransitionEnd',
      MozTransition    : 'transitionend',
      OTransition      : 'oTransitionEnd otransitionend',
      transition       : 'transitionend'
    }

    for (var name in transEndEventNames) {
      if (el.style[name] !== undefined) {
        return { end: transEndEventNames[name] }
      }
    }

    return false // explicit for ie8 (  ._.)
  }

  // http://blog.alexmaccaw.com/css-transitions
  $.fn.emulateTransitionEnd = function (duration) {
    var called = false
    var $el = this
    $(this).one('bsTransitionEnd', function () { called = true })
    var callback = function () { if (!called) $($el).trigger($.support.transition.end) }
    setTimeout(callback, duration)
    return this
  }

  $(function () {
    $.support.transition = transitionEnd()

    if (!$.support.transition) return

    $.event.special.bsTransitionEnd = {
      bindType: $.support.transition.end,
      delegateType: $.support.transition.end,
      handle: function (e) {
        if ($(e.target).is(this)) return e.handleObj.handler.apply(this, arguments)
      }
    }
  })

}(jQuery);
</script>
<script>
/* ========================================================================
 * Bootstrap: collapse.js v3.3.7
 * http://getbootstrap.com/javascript/#collapse
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* jshint latedef: false */

+function ($) {
  'use strict';

  // COLLAPSE PUBLIC CLASS DEFINITION
  // ================================

  var Collapse = function (element, options) {
    this.$element      = $(element)
    this.options       = $.extend({}, Collapse.DEFAULTS, options)
    this.$trigger      = $('[data-toggle="collapse"][href="#' + element.id + '"],' +
                           '[data-toggle="collapse"][data-target="#' + element.id + '"]')
    this.transitioning = null

    if (this.options.parent) {
      this.$parent = this.getParent()
    } else {
      this.addAriaAndCollapsedClass(this.$element, this.$trigger)
    }

    if (this.options.toggle) this.toggle()
  }

  Collapse.VERSION  = '3.3.7'

  Collapse.TRANSITION_DURATION = 350

  Collapse.DEFAULTS = {
    toggle: true
  }

  Collapse.prototype.dimension = function () {
    var hasWidth = this.$element.hasClass('width')
    return hasWidth ? 'width' : 'height'
  }

  Collapse.prototype.show = function () {
    if (this.transitioning || this.$element.hasClass('in')) return

    var activesData
    var actives = this.$parent && this.$parent.children('.panel').children('.in, .collapsing')

    if (actives && actives.length) {
      activesData = actives.data('bs.collapse')
      if (activesData && activesData.transitioning) return
    }

    var startEvent = $.Event('show.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    if (actives && actives.length) {
      Plugin.call(actives, 'hide')
      activesData || actives.data('bs.collapse', null)
    }

    var dimension = this.dimension()

    this.$element
      .removeClass('collapse')
      .addClass('collapsing')[dimension](0)
      .attr('aria-expanded', true)

    this.$trigger
      .removeClass('collapsed')
      .attr('aria-expanded', true)

    this.transitioning = 1

    var complete = function () {
      this.$element
        .removeClass('collapsing')
        .addClass('collapse in')[dimension]('')
      this.transitioning = 0
      this.$element
        .trigger('shown.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    var scrollSize = $.camelCase(['scroll', dimension].join('-'))

    this.$element
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)[dimension](this.$element[0][scrollSize])
  }

  Collapse.prototype.hide = function () {
    if (this.transitioning || !this.$element.hasClass('in')) return

    var startEvent = $.Event('hide.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    var dimension = this.dimension()

    this.$element[dimension](this.$element[dimension]())[0].offsetHeight

    this.$element
      .addClass('collapsing')
      .removeClass('collapse in')
      .attr('aria-expanded', false)

    this.$trigger
      .addClass('collapsed')
      .attr('aria-expanded', false)

    this.transitioning = 1

    var complete = function () {
      this.transitioning = 0
      this.$element
        .removeClass('collapsing')
        .addClass('collapse')
        .trigger('hidden.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    this.$element
      [dimension](0)
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)
  }

  Collapse.prototype.toggle = function () {
    this[this.$element.hasClass('in') ? 'hide' : 'show']()
  }

  Collapse.prototype.getParent = function () {
    return $(this.options.parent)
      .find('[data-toggle="collapse"][data-parent="' + this.options.parent + '"]')
      .each($.proxy(function (i, element) {
        var $element = $(element)
        this.addAriaAndCollapsedClass(getTargetFromTrigger($element), $element)
      }, this))
      .end()
  }

  Collapse.prototype.addAriaAndCollapsedClass = function ($element, $trigger) {
    var isOpen = $element.hasClass('in')

    $element.attr('aria-expanded', isOpen)
    $trigger
      .toggleClass('collapsed', !isOpen)
      .attr('aria-expanded', isOpen)
  }

  function getTargetFromTrigger($trigger) {
    var href
    var target = $trigger.attr('data-target')
      || (href = $trigger.attr('href')) && href.replace(/.*(?=#[^\s]+$)/, '') // strip for ie7

    return $(target)
  }


  // COLLAPSE PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this   = $(this)
      var data    = $this.data('bs.collapse')
      var options = $.extend({}, Collapse.DEFAULTS, $this.data(), typeof option == 'object' && option)

      if (!data && options.toggle && /show|hide/.test(option)) options.toggle = false
      if (!data) $this.data('bs.collapse', (data = new Collapse(this, options)))
      if (typeof option == 'string') data[option]()
    })
  }

  var old = $.fn.collapse

  $.fn.collapse             = Plugin
  $.fn.collapse.Constructor = Collapse


  // COLLAPSE NO CONFLICT
  // ====================

  $.fn.collapse.noConflict = function () {
    $.fn.collapse = old
    return this
  }


  // COLLAPSE DATA-API
  // =================

  $(document).on('click.bs.collapse.data-api', '[data-toggle="collapse"]', function (e) {
    var $this   = $(this)

    if (!$this.attr('data-target')) e.preventDefault()

    var $target = getTargetFromTrigger($this)
    var data    = $target.data('bs.collapse')
    var option  = data ? 'toggle' : $this.data()

    Plugin.call($target, option)
  })

}(jQuery);
</script>
<script>
window.initializeCodeFolding = function(show) {

  // handlers for show-all and hide all
  $("#rmd-show-all-code").click(function() {
    // close the dropdown menu when an option is clicked
    $("#allCodeButton").dropdown("toggle");
    $('div.r-code-collapse').each(function() {
      $(this).collapse('show');
    });
  });
  $("#rmd-hide-all-code").click(function() {
    // close the dropdown menu when an option is clicked
    $("#allCodeButton").dropdown("toggle");
    $('div.r-code-collapse').each(function() {
      $(this).collapse('hide');
    });
  });

  // index for unique code element ids
  var currentIndex = 1;

  // select all R code blocks
  var rCodeBlocks = $('pre.sourceCode, pre.r, pre.python, pre.bash, pre.sql, pre.cpp, pre.stan');
  rCodeBlocks.each(function() {

    // create a collapsable div to wrap the code in
    var div = $('<div class="collapse r-code-collapse"></div>');
    if (show)
      div.addClass('in');
    var id = 'rcode-643E0F36' + currentIndex++;
    div.attr('id', id);
    $(this).before(div);
    $(this).detach().appendTo(div);

    // add a show code button right above
    var showCodeText = $('<span>' + (show ? 'Hide' : 'Code') + '</span>');
    var showCodeButton = $('<button type="button" class="btn btn-default btn-xs code-folding-btn pull-right"></button>');
    showCodeButton.append(showCodeText);
    showCodeButton
        .attr('data-toggle', 'collapse')
        .attr('data-target', '#' + id)
        .attr('aria-expanded', show)
        .attr('aria-controls', id);

    var buttonRow = $('<div class="row"></div>');
    var buttonCol = $('<div class="col-md-12"></div>');

    buttonCol.append(showCodeButton);
    buttonRow.append(buttonCol);

    div.before(buttonRow);

    // update state of button on show/hide
    div.on('hidden.bs.collapse', function () {
      showCodeText.text('Code');
    });
    div.on('show.bs.collapse', function () {
      showCodeText.text('Hide');
    });
  });

}
</script>
<script>
/* ========================================================================
 * Bootstrap: dropdown.js v3.3.7
 * http://getbootstrap.com/javascript/#dropdowns
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // DROPDOWN CLASS DEFINITION
  // =========================

  var backdrop = '.dropdown-backdrop'
  var toggle   = '[data-toggle="dropdown"]'
  var Dropdown = function (element) {
    $(element).on('click.bs.dropdown', this.toggle)
  }

  Dropdown.VERSION = '3.3.7'

  function getParent($this) {
    var selector = $this.attr('data-target')

    if (!selector) {
      selector = $this.attr('href')
      selector = selector && /#[A-Za-z]/.test(selector) && selector.replace(/.*(?=#[^\s]*$)/, '') // strip for ie7
    }

    var $parent = selector && $(selector)

    return $parent && $parent.length ? $parent : $this.parent()
  }

  function clearMenus(e) {
    if (e && e.which === 3) return
    $(backdrop).remove()
    $(toggle).each(function () {
      var $this         = $(this)
      var $parent       = getParent($this)
      var relatedTarget = { relatedTarget: this }

      if (!$parent.hasClass('open')) return

      if (e && e.type == 'click' && /input|textarea/i.test(e.target.tagName) && $.contains($parent[0], e.target)) return

      $parent.trigger(e = $.Event('hide.bs.dropdown', relatedTarget))

      if (e.isDefaultPrevented()) return

      $this.attr('aria-expanded', 'false')
      $parent.removeClass('open').trigger($.Event('hidden.bs.dropdown', relatedTarget))
    })
  }

  Dropdown.prototype.toggle = function (e) {
    var $this = $(this)

    if ($this.is('.disabled, :disabled')) return

    var $parent  = getParent($this)
    var isActive = $parent.hasClass('open')

    clearMenus()

    if (!isActive) {
      if ('ontouchstart' in document.documentElement && !$parent.closest('.navbar-nav').length) {
        // if mobile we use a backdrop because click events don't delegate
        $(document.createElement('div'))
          .addClass('dropdown-backdrop')
          .insertAfter($(this))
          .on('click', clearMenus)
      }

      var relatedTarget = { relatedTarget: this }
      $parent.trigger(e = $.Event('show.bs.dropdown', relatedTarget))

      if (e.isDefaultPrevented()) return

      $this
        .trigger('focus')
        .attr('aria-expanded', 'true')

      $parent
        .toggleClass('open')
        .trigger($.Event('shown.bs.dropdown', relatedTarget))
    }

    return false
  }

  Dropdown.prototype.keydown = function (e) {
    if (!/(38|40|27|32)/.test(e.which) || /input|textarea/i.test(e.target.tagName)) return

    var $this = $(this)

    e.preventDefault()
    e.stopPropagation()

    if ($this.is('.disabled, :disabled')) return

    var $parent  = getParent($this)
    var isActive = $parent.hasClass('open')

    if (!isActive && e.which != 27 || isActive && e.which == 27) {
      if (e.which == 27) $parent.find(toggle).trigger('focus')
      return $this.trigger('click')
    }

    var desc = ' li:not(.disabled):visible a'
    var $items = $parent.find('.dropdown-menu' + desc)

    if (!$items.length) return

    var index = $items.index(e.target)

    if (e.which == 38 && index > 0)                 index--         // up
    if (e.which == 40 && index < $items.length - 1) index++         // down
    if (!~index)                                    index = 0

    $items.eq(index).trigger('focus')
  }


  // DROPDOWN PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this = $(this)
      var data  = $this.data('bs.dropdown')

      if (!data) $this.data('bs.dropdown', (data = new Dropdown(this)))
      if (typeof option == 'string') data[option].call($this)
    })
  }

  var old = $.fn.dropdown

  $.fn.dropdown             = Plugin
  $.fn.dropdown.Constructor = Dropdown


  // DROPDOWN NO CONFLICT
  // ====================

  $.fn.dropdown.noConflict = function () {
    $.fn.dropdown = old
    return this
  }


  // APPLY TO STANDARD DROPDOWN ELEMENTS
  // ===================================

  $(document)
    .on('click.bs.dropdown.data-api', clearMenus)
    .on('click.bs.dropdown.data-api', '.dropdown form', function (e) { e.stopPropagation() })
    .on('click.bs.dropdown.data-api', toggle, Dropdown.prototype.toggle)
    .on('keydown.bs.dropdown.data-api', toggle, Dropdown.prototype.keydown)
    .on('keydown.bs.dropdown.data-api', '.dropdown-menu', Dropdown.prototype.keydown)

}(jQuery);
</script>
<style type="text/css">
.code-folding-btn {
  margin-bottom: 4px;
}

.row { display: flex; }
.collapse { display: none; }
.in { display:block }
.pull-right > .dropdown-menu {
    right: 0;
    left: auto;
}

.dropdown-menu {
    position: absolute;
    top: 100%;
    left: 0;
    z-index: 1000;
    display: none;
    float: left;
    min-width: 160px;
    padding: 5px 0;
    margin: 2px 0 0;
    font-size: 14px;
    text-align: left;
    list-style: none;
    background-color: #fff;
    -webkit-background-clip: padding-box;
    background-clip: padding-box;
    border: 1px solid #ccc;
    border: 1px solid rgba(0,0,0,.15);
    border-radius: 4px;
    -webkit-box-shadow: 0 6px 12px rgba(0,0,0,.175);
    box-shadow: 0 6px 12px rgba(0,0,0,.175);
}

.open > .dropdown-menu {
    display: block;
    color: #ffffff;
    background-color: #ffffff;
    background-image: none;
    border-color: #92897e;
}

.dropdown-menu > li > a {
  display: block;
  padding: 3px 20px;
  clear: both;
  font-weight: 400;
  line-height: 1.42857143;
  color: #000000;
  white-space: nowrap;
}

.dropdown-menu > li > a:hover,
.dropdown-menu > li > a:focus {
  color: #ffffff;
  text-decoration: none;
  background-color: #e95420;
}

.dropdown-menu > .active > a,
.dropdown-menu > .active > a:hover,
.dropdown-menu > .active > a:focus {
  color: #ffffff;
  text-decoration: none;
  background-color: #e95420;
  outline: 0;
}
.dropdown-menu > .disabled > a,
.dropdown-menu > .disabled > a:hover,
.dropdown-menu > .disabled > a:focus {
  color: #aea79f;
}

.dropdown-menu > .disabled > a:hover,
.dropdown-menu > .disabled > a:focus {
  text-decoration: none;
  cursor: not-allowed;
  background-color: transparent;
  background-image: none;
  filter: progid:DXImageTransform.Microsoft.gradient(enabled = false);
}

.btn {
  display: inline-block;
  margin-bottom: 1;
  font-weight: normal;
  text-align: center;
  white-space: nowrap;
  vertical-align: middle;
  -ms-touch-action: manipulation;
      touch-action: manipulation;
  cursor: pointer;
  background-image: none;
  border: 1px solid transparent;
  padding: 4px 8px;
  font-size: 14px;
  line-height: 1.42857143;
  border-radius: 4px;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.btn:focus,
.btn:active:focus,
.btn.active:focus,
.btn.focus,
.btn:active.focus,
.btn.active.focus {
  outline: 5px auto -webkit-focus-ring-color;
  outline-offset: -2px;
}
.btn:hover,
.btn:focus,
.btn.focus {
  color: #ffffff;
  text-decoration: none;
}
.btn:active,
.btn.active {
  background-image: none;
  outline: 0;
  box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
}
.btn.disabled,
.btn[disabled],
fieldset[disabled] .btn {
  cursor: not-allowed;
  filter: alpha(opacity=65);
  opacity: 0.65;
  box-shadow: none;
}
a.btn.disabled,
fieldset[disabled] a.btn {
  pointer-events: none;
}
.btn-default {
  color: #ffffff;
  background-color: #aea79f; #important
  border-color: #aea79f;
}

.btn-default:focus,
.btn-default.focus {
  color: #ffffff;
  background-color: #978e83;
  border-color: #6f675e;
}

.btn-default:hover {
  color: #ffffff;
  background-color: #978e83;
  border-color: #92897e;
}
.btn-default:active,
.btn-default.active,
.btn-group > .btn:not(:first-child):not(:last-child):not(.dropdown-toggle) {
  border-radius: 0;
}
.btn-group > .btn:first-child {
  margin-left: 0;
}
.btn-group > .btn:first-child:not(:last-child):not(.dropdown-toggle) {
  border-top-right-radius: 0;
  border-bottom-right-radius: 0;
}
.btn-group > .btn:last-child:not(:first-child),
.btn-group > .dropdown-toggle:not(:first-child) {
  border-top-left-radius: 0;
  border-bottom-left-radius: 0;
}
.btn-group > .btn-group {
  float: left;
}
.btn-group > .btn-group:not(:first-child):not(:last-child) > .btn {
  border-radius: 0;
}
.btn-group > .btn-group:first-child:not(:last-child) > .btn:last-child,
.btn-group > .btn-group:first-child:not(:last-child) > .dropdown-toggle {
  border-top-right-radius: 0;
  border-bottom-right-radius: 0;
}
.btn-group > .btn-group:last-child:not(:first-child) > .btn:first-child {
  border-top-left-radius: 0;
  border-bottom-left-radius: 0;
}
.btn-group .dropdown-toggle:active,
.btn-group.open .dropdown-toggle {
  outline: 0;
}
.btn-group > .btn + .dropdown-toggle {
  padding-right: 8px;
  padding-left: 8px;
}
.btn-group > .btn-lg + .dropdown-toggle {
  padding-right: 12px;
  padding-left: 12px;
}
.btn-group.open .dropdown-toggle {
  box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
}
.btn-group.open .dropdown-toggle.btn-link {
  box-shadow: none;
}

</style>
<script>
var str = '<div class="btn-group pull-right" style="position: fixed; right: 50px; top: 10px; z-index: 200"><button type="button" class="btn btn-default btn-xs dropdown-toggle" id="allCodeButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true" data-_extension-text-contrast=""><span>Code</span> <span class="caret"></span></button><ul class="dropdown-menu" style="min-width: 50px;"><li><a id="rmd-show-all-code" href="#">Show All Code</a></li><li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li></ul></div>';
document.write(str);
</script>
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "hide");
});
</script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Biomarker atopo analysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Intro</a></li>
<li class="chapter" data-level="" data-path="a498-model-analysis.html"><a href="a498-model-analysis.html"><i class="fa fa-check"></i>A498 Model Analysis</a><ul>
<li class="chapter" data-level="" data-path="a498-model-analysis.html"><a href="a498-model-analysis.html#input"><i class="fa fa-check"></i>Input</a></li>
<li class="chapter" data-level="" data-path="a498-model-analysis.html"><a href="a498-model-analysis.html#performance-statistics"><i class="fa fa-check"></i>Performance Statistics</a></li>
<li class="chapter" data-level="" data-path="a498-model-analysis.html"><a href="a498-model-analysis.html#biomarker-analysis"><i class="fa fa-check"></i>Biomarker analysis</a><ul>
<li class="chapter" data-level="" data-path="a498-model-analysis.html"><a href="a498-model-analysis.html#intro-methods"><i class="fa fa-check"></i>Intro-Methods</a></li>
<li class="chapter" data-level="" data-path="a498-model-analysis.html"><a href="a498-model-analysis.html#true-positives-based-analysis"><i class="fa fa-check"></i>True Positives-based analysis</a></li>
<li class="chapter" data-level="" data-path="a498-model-analysis.html"><a href="a498-model-analysis.html#mcc-classification-based-analysis"><i class="fa fa-check"></i>MCC classification-based analysis</a></li>
<li class="chapter" data-level="" data-path="a498-model-analysis.html"><a href="a498-model-analysis.html#performance-related-biomarkers"><i class="fa fa-check"></i>Performance-related biomarkers</a></li>
<li class="chapter" data-level="" data-path="a498-model-analysis.html"><a href="a498-model-analysis.html#equation-based-analysis"><i class="fa fa-check"></i>Equation-based analysis</a></li>
<li class="chapter" data-level="" data-path="a498-model-analysis.html"><a href="a498-model-analysis.html#synergy-prediction-based-analysis"><i class="fa fa-check"></i>Synergy-prediction based analysis</a></li>
<li class="chapter" data-level="" data-path="a498-model-analysis.html"><a href="a498-model-analysis.html#synergy-set-prediction-based-analysis"><i class="fa fa-check"></i>Synergy-set prediction based analysis</a><ul>
<li class="chapter" data-level="" data-path="a498-model-analysis.html"><a href="a498-model-analysis.html#pd-pi-synergy"><i class="fa fa-check"></i>PD-PI synergy</a></li>
<li class="chapter" data-level="" data-path="a498-model-analysis.html"><a href="a498-model-analysis.html#bi-pd-synergy"><i class="fa fa-check"></i>BI-PD synergy</a></li>
<li class="chapter" data-level="" data-path="a498-model-analysis.html"><a href="a498-model-analysis.html#bi-pi-synergy"><i class="fa fa-check"></i>BI-PI synergy</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="a498-model-analysis.html"><a href="a498-model-analysis.html#biomarker-results"><i class="fa fa-check"></i>Biomarker results</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="ags-model-analysis.html"><a href="ags-model-analysis.html"><i class="fa fa-check"></i>AGS Model Analysis</a><ul>
<li class="chapter" data-level="" data-path="ags-model-analysis.html"><a href="ags-model-analysis.html#input-1"><i class="fa fa-check"></i>Input</a></li>
<li class="chapter" data-level="" data-path="ags-model-analysis.html"><a href="ags-model-analysis.html#performance-statistics-1"><i class="fa fa-check"></i>Performance Statistics</a></li>
<li class="chapter" data-level="" data-path="ags-model-analysis.html"><a href="ags-model-analysis.html#biomarker-analysis-1"><i class="fa fa-check"></i>Biomarker analysis</a><ul>
<li class="chapter" data-level="" data-path="ags-model-analysis.html"><a href="ags-model-analysis.html#intro-methods-1"><i class="fa fa-check"></i>Intro-Methods</a></li>
<li class="chapter" data-level="" data-path="ags-model-analysis.html"><a href="ags-model-analysis.html#true-positives-based-analysis-1"><i class="fa fa-check"></i>True Positives-based analysis</a></li>
<li class="chapter" data-level="" data-path="ags-model-analysis.html"><a href="ags-model-analysis.html#mcc-classification-based-analysis-1"><i class="fa fa-check"></i>MCC classification-based analysis</a></li>
<li class="chapter" data-level="" data-path="ags-model-analysis.html"><a href="ags-model-analysis.html#performance-related-biomarkers-1"><i class="fa fa-check"></i>Performance-related biomarkers</a></li>
<li class="chapter" data-level="" data-path="ags-model-analysis.html"><a href="ags-model-analysis.html#equation-based-analysis-1"><i class="fa fa-check"></i>Equation-based analysis</a></li>
<li class="chapter" data-level="" data-path="ags-model-analysis.html"><a href="ags-model-analysis.html#synergy-prediction-based-analysis-1"><i class="fa fa-check"></i>Synergy-prediction based analysis</a></li>
<li class="chapter" data-level="" data-path="ags-model-analysis.html"><a href="ags-model-analysis.html#synergy-set-prediction-based-analysis-1"><i class="fa fa-check"></i>Synergy-set prediction based analysis</a><ul>
<li class="chapter" data-level="" data-path="ags-model-analysis.html"><a href="ags-model-analysis.html#bi-d1-synergy"><i class="fa fa-check"></i>BI-D1 synergy</a></li>
<li class="chapter" data-level="" data-path="ags-model-analysis.html"><a href="ags-model-analysis.html#pi-d1-synergy"><i class="fa fa-check"></i>PI-D1 synergy</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ags-model-analysis.html"><a href="ags-model-analysis.html#biomarker-results-1"><i class="fa fa-check"></i>Biomarker results</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="session-info.html"><a href="session-info.html"><i class="fa fa-check"></i>Session Info</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Biomarker Atopo Analysis (2500 models per cell line, 8 cell lines)</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ags-model-analysis" class="section level1 unnumbered">
<h1>AGS Model Analysis</h1>
<p>This chapter includes the ensemble model analysis performed on the models
generated by the <code>Gitsbe</code> module when running the DrugLogics computational
pipeline for finding synergistic drug combinations (drug pairs). All these
models were trained towards a specific steady state signaling pattern that was
derived based on input data (gene expression, CNV) for the <code>AGS</code> cell line, the
use of the PARADIGM software <span class="citation">(Vaske et al. <a href="references.html#ref-Vaske2010">2010</a>)</span> and
a topology that was build for simulating a cancer cell fate decision network.
The input for the simulations and the output data are in the <code>cell-lines-2500</code>
directory (the 2500 number denotes the number of simulations executed). The
analysis will be presented step by step in the sections below.</p>
<div id="input-1" class="section level2 unnumbered">
<h2>Input</h2>
<p>We will define the name of the cell line which must match the name of the
directory that has the input files inside the <code>cell-lines-2500</code> directory. Our
analysis in this chapter will be done on the data for the <code>AGS</code> cell line:</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" title="1">cell.line =<span class="st"> &quot;AGS&quot;</span></a>
<a class="sourceLine" id="cb61-2" title="2">data.dir =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">getwd</span>(), <span class="st">&quot;/&quot;</span>, cell.line, <span class="st">&quot;/&quot;</span>)</a></code></pre></div>
<p><strong>Three inputs</strong> are used in this analysis:</p>
<ul>
<li>The <strong>model_predictions</strong> file which has for each model the prediction for
each drug combination tested (<em>0</em> = no synergy predicted, <em>1</em> = synergy
predicted, <em>NA</em> = couldn’t find stable states in either the drug combination
inhibited model or in any of the two single-drug inhibited models)</li>
<li>The <strong>observed_synergies</strong> file which lists the drug combinations that were
observed as synergistic for the particular cell line.</li>
<li>The <strong>models</strong> directory, which is the same as the models directory produced
by <code>Gitsbe</code> and has one <code>.gitsbe</code> file per model that includes this info:
<ul>
<li>The <em>stable state</em> of the boolean model. Note that a model can have 1
stable state or none in our simulations - but the models used in this analysis
have been selected through a genetic evolution algorithm in <code>Gitsbe</code> and so in
the end, only those with 1 stable state have higher fitness values and remain in
the later generations. Higher fitness here means a better match of a model’s
stable state to the cell line derived steady state (a perfect match would result
in a fitness of 1)</li>
<li>The <em>boolean equations</em> of the model</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" title="1">models.stable.state.file =<span class="st"> </span><span class="kw">paste0</span>(data.dir, <span class="st">&quot;models_stable_state&quot;</span>)</a>
<a class="sourceLine" id="cb62-2" title="2">observed.synergies.file  =<span class="st"> </span><span class="kw">paste0</span>(data.dir, <span class="st">&quot;observed_synergies&quot;</span>)</a>
<a class="sourceLine" id="cb62-3" title="3">model.predictions.file   =<span class="st"> </span><span class="kw">paste0</span>(data.dir, <span class="st">&quot;model_predictions&quot;</span>)</a>
<a class="sourceLine" id="cb62-4" title="4">models.equations.file    =<span class="st"> </span><span class="kw">paste0</span>(data.dir, <span class="st">&quot;models_equations&quot;</span>)</a>
<a class="sourceLine" id="cb62-5" title="5">models.dir =<span class="st"> </span><span class="kw">paste0</span>(data.dir, <span class="st">&quot;models&quot;</span>)</a></code></pre></div>
<p>Now, we parse the data into proper R objects. First the synergy predictions
per model:</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" title="1">model.predictions =<span class="st"> </span><span class="kw">get_model_predictions</span>(model.predictions.file)</a>
<a class="sourceLine" id="cb63-2" title="2"></a>
<a class="sourceLine" id="cb63-3" title="3"><span class="co"># Example: first model&#39;s synergy predictions (first 12 drug combinations)</span></a>
<a class="sourceLine" id="cb63-4" title="4"><span class="kw">pretty_print_vector_names_and_values</span>(model.predictions[<span class="dv">1</span>,], <span class="dt">n =</span> <span class="dv">12</span>)</a></code></pre></div>
<blockquote>
<p>5Z-AK: 0, 5Z-BI: 0, 5Z-CT: 0, 5Z-PD: 0, 5Z-PI: 0, 5Z-PK: 0, 5Z-JN: 0, 5Z-D1: 0, 5Z-60: 0, 5Z-SB: 0, 5Z-RU: 0, 5Z-D4: 0</p>
</blockquote>
<p>So, the <code>model.predictions</code> object has the models as rows and each column is a
different drug combination that was tested in our simulations.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" title="1">drug.combinations.tested =<span class="st"> </span><span class="kw">colnames</span>(model.predictions)</a>
<a class="sourceLine" id="cb64-2" title="2">models                   =<span class="st"> </span><span class="kw">rownames</span>(model.predictions)</a>
<a class="sourceLine" id="cb64-3" title="3">nodes                    =<span class="st"> </span><span class="kw">get_node_names</span>(models.dir)</a>
<a class="sourceLine" id="cb64-4" title="4"></a>
<a class="sourceLine" id="cb64-5" title="5">number.of.drug.comb.tested =<span class="st"> </span><span class="kw">length</span>(drug.combinations.tested)</a>
<a class="sourceLine" id="cb64-6" title="6">number.of.models           =<span class="st"> </span><span class="kw">length</span>(models)</a>
<a class="sourceLine" id="cb64-7" title="7">number.of.nodes            =<span class="st"> </span><span class="kw">length</span>(nodes)</a>
<a class="sourceLine" id="cb64-8" title="8"></a>
<a class="sourceLine" id="cb64-9" title="9"><span class="kw">print_model_and_drug_stats</span>(number.of.drug.comb.tested, number.of.models, </a>
<a class="sourceLine" id="cb64-10" title="10">                           number.of.nodes, <span class="dt">html.output =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<blockquote>
<p>Drug combinations tested: 153<br/>Number of models: 7500<br/>Number of nodes: 139</p>
</blockquote>
<p>Next, we get the full stable state and the equations per model:</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb65-1" title="1">models.stable.state =<span class="st"> </span><span class="kw">as.matrix</span>(</a>
<a class="sourceLine" id="cb65-2" title="2">  <span class="kw">read.table</span>(<span class="dt">file =</span> models.stable.state.file, <span class="dt">check.names =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb65-3" title="3">)</a>
<a class="sourceLine" id="cb65-4" title="4"></a>
<a class="sourceLine" id="cb65-5" title="5"><span class="co"># Example: first model&#39;s stable state (first 12 nodes)</span></a>
<a class="sourceLine" id="cb65-6" title="6"><span class="kw">pretty_print_vector_names_and_values</span>(models.stable.state[<span class="dv">1</span>,], <span class="dt">n =</span> <span class="dv">12</span>)</a></code></pre></div>
<blockquote>
<p>MAP3K7: 1, MAP2K6: 1, MAP2K3: 1, NLK: 1, MAP3K4: 0, MAP2K4: 1, IKBKG: 1, IKBKB: 0, AKT1: 0, BRAF: 0, SMAD3: 0, DAB2IP: 1</p>
</blockquote>
<p>The rows of the <code>models.stable.state</code> object represent the models while its
columns are the names of the nodes (proteins, genes, etc.) of the cancer cell
network under study. So, each model has one stable state which means that in
every model, <strong>the nodes in the network have reached a state of either 0
(inhibition) or 1 (activation)</strong>.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" title="1">models.equations =<span class="st"> </span><span class="kw">as.matrix</span>(</a>
<a class="sourceLine" id="cb66-2" title="2">  <span class="kw">read.table</span>(<span class="dt">file =</span> models.equations.file, <span class="dt">check.names =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb66-3" title="3">)</a>
<a class="sourceLine" id="cb66-4" title="4"></a>
<a class="sourceLine" id="cb66-5" title="5"><span class="co"># Example: first model&#39;s link operators (first 12 nodes)</span></a>
<a class="sourceLine" id="cb66-6" title="6"><span class="kw">pretty_print_vector_names_and_values</span>(models.equations[<span class="dv">1</span>,], <span class="dt">n =</span> <span class="dv">12</span>)</a></code></pre></div>
<blockquote>
<p>MAP3K4: 0, MAP2K4: 1, IKBKB: 0, AKT1: 0, SMAD3: 0, GSK3B: 1, RAF1: 0, GAB2: 0, CTNNB1: 0, NR3C1: 0, CREB1: 0, RAC1: 1</p>
</blockquote>
<p>For the <code>models.equations</code>, if we look at a specific row (a model so to speak),
the columns (node names) correspond to the <em>targets of regulation</em> (and the
network has been built so that <em>every node is a target</em> - i.e. it has other
nodes activating and/or inhibiting it). The general form of a boolean equation
is:</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" title="1">general.equation =<span class="st"> </span></a>
<a class="sourceLine" id="cb67-2" title="2"><span class="st">  &quot;Target *= (Activator OR Activator OR...) AND NOT (Inhibitor OR Inhibitor OR...)&quot;</span></a>
<a class="sourceLine" id="cb67-3" title="3"><span class="kw">pretty_print_bold_string</span>(general.equation)</a></code></pre></div>
<blockquote>
<p><b>Target *= (Activator OR Activator OR…) AND NOT (Inhibitor OR Inhibitor OR…)</b></p>
</blockquote>
<p>The difference between the models’ boolean equations is the <em>link operator</em>
(OR NOT/AND NOT) which has been mutated (changed) through the evolutionary
process of the genetic algorithm in <code>Gitsbe</code>. For example, if a model has for
the column <code>ERK_f</code> (of the <code>models.equations</code> object) <strong>a value of 1</strong>, the correspoding
equation is: ERK_f *= (MEK_f) <strong>OR NOT</strong> ((DUSP6) OR PPP1CA). <strong>A value of 0</strong> would
correspond to the same equation but having <strong>AND NOT</strong> as the link operator:
ERK_f *= (MEK_f) <strong>AND NOT</strong> ((DUSP6) OR PPP1CA). Note that the equations that do
not have link operators (meaning that they are <em>the same for every model</em>) are
discarded (so less columns in this dataset) since in a later section we study only
the equations whose link operators differentiate between the models.</p>
<p>Lastly, the synergies observed for this particular cell line are:</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb68-1" title="1">observed.synergies =<span class="st"> </span><span class="kw">get_observed_synergies</span>(</a>
<a class="sourceLine" id="cb68-2" title="2">  observed.synergies.file, drug.combinations.tested)</a>
<a class="sourceLine" id="cb68-3" title="3">number.of.observed.synergies =<span class="st"> </span><span class="kw">length</span>(observed.synergies)</a>
<a class="sourceLine" id="cb68-4" title="4"></a>
<a class="sourceLine" id="cb68-5" title="5"><span class="kw">pretty_print_vector_values</span>(observed.synergies, </a>
<a class="sourceLine" id="cb68-6" title="6">                           <span class="dt">vector.values.str =</span> <span class="st">&quot;observed synergies&quot;</span>)</a></code></pre></div>
<blockquote>
<p>6 observed synergies: AK-BI, 5Z-D1, AK-D1, BI-D1, PI-D1, PK-ST</p>
</blockquote>
</div>
<div id="performance-statistics-1" class="section level2 unnumbered">
<h2>Performance Statistics</h2>
<p>It will be interesting to know the percentage of the above observed synergies
that were actually predicted by at least one of the models (there might be
combinations that no model in our dataset could predict):</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb69-1" title="1"><span class="co"># Split model.predictions to positive and negative results</span></a>
<a class="sourceLine" id="cb69-2" title="2">observed.model.predictions =<span class="st"> </span></a>
<a class="sourceLine" id="cb69-3" title="3"><span class="st">  </span><span class="kw">get_observed_model_predictions</span>(model.predictions, observed.synergies)</a>
<a class="sourceLine" id="cb69-4" title="4">unobserved.model.predictions =<span class="st"> </span></a>
<a class="sourceLine" id="cb69-5" title="5"><span class="st">  </span><span class="kw">get_unobserved_model_predictions</span>(model.predictions, observed.synergies)</a>
<a class="sourceLine" id="cb69-6" title="6"></a>
<a class="sourceLine" id="cb69-7" title="7"><span class="kw">stopifnot</span>(<span class="kw">dim</span>(observed.model.predictions)[<span class="dv">2</span>] <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb69-8" title="8"><span class="st">          </span><span class="kw">dim</span>(unobserved.model.predictions)[<span class="dv">2</span>] <span class="op">==</span><span class="st"> </span>number.of.drug.comb.tested)</a>
<a class="sourceLine" id="cb69-9" title="9"></a>
<a class="sourceLine" id="cb69-10" title="10">number.of.models.per.observed.synergy =<span class="st"> </span></a>
<a class="sourceLine" id="cb69-11" title="11"><span class="st">  </span><span class="kw">colSums</span>(observed.model.predictions, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb69-12" title="12">predicted.synergies =<span class="st"> </span><span class="kw">names</span>(<span class="kw">which</span>(number.of.models.per.observed.synergy <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>))</a>
<a class="sourceLine" id="cb69-13" title="13"></a>
<a class="sourceLine" id="cb69-14" title="14"><span class="co"># predicted synergies is a subset of the observed (positive) ones</span></a>
<a class="sourceLine" id="cb69-15" title="15"><span class="kw">stopifnot</span>(<span class="kw">all</span>(predicted.synergies <span class="op">%in%</span><span class="st"> </span>observed.synergies))</a></code></pre></div>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" title="1"><span class="kw">pretty_print_vector_values</span>(predicted.synergies, </a>
<a class="sourceLine" id="cb70-2" title="2">                           <span class="dt">vector.values.str =</span> <span class="st">&quot;predicted synergies&quot;</span>)</a></code></pre></div>
<blockquote>
<p>2 predicted synergies: BI-D1, PI-D1</p>
</blockquote>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb71-1" title="1">predicted.synergies.percentage =<span class="st"> </span><span class="dv">100</span> <span class="op">*</span><span class="st"> </span><span class="kw">length</span>(predicted.synergies) <span class="op">/</span></a>
<a class="sourceLine" id="cb71-2" title="2"><span class="st">                    </span>number.of.observed.synergies</a>
<a class="sourceLine" id="cb71-3" title="3"><span class="kw">pretty_print_string</span>(<span class="kw">paste0</span>(<span class="st">&quot;Percentage of True Positive predicted synergies: &quot;</span>, </a>
<a class="sourceLine" id="cb71-4" title="4">                    <span class="kw">specify_decimal</span>(predicted.synergies.percentage, <span class="dv">2</span>), <span class="st">&quot;%&quot;</span>))</a></code></pre></div>
<blockquote>
<p>Percentage of True Positive predicted synergies: 33.33%</p>
</blockquote>
<p>So, for this particular cell line, <strong>there were indeed observed synergies that no
model could predict</strong> (e.g. 
5Z-D1,
AK-BI).
Next, we would like to know the maximum
number of observed synergies predicted by one model alone - <strong>can one model by itself
predict all the true positive synergies predicted by all the models together</strong> or
do we need many models to capture this diverse synergy landscape? To do that, we
go even further and <strong>count the number of models that predict a specific set of
observed synergies</strong> for every possible combination subset of the <code>predicted.synergies</code>
object:</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb72-1" title="1"><span class="co"># Find the number of predictive models for every synergy subset</span></a>
<a class="sourceLine" id="cb72-2" title="2">synergy.subset.stats =<span class="st"> </span><span class="kw">get_synergy_subset_stats</span>(observed.model.predictions, predicted.synergies)</a>
<a class="sourceLine" id="cb72-3" title="3"></a>
<a class="sourceLine" id="cb72-4" title="4"><span class="co"># Bar plot of the number of models for every possible observed synergy combination set</span></a>
<a class="sourceLine" id="cb72-5" title="5"><span class="co"># Tweak the threshold.for.subset.removal and bottom.margin as desired</span></a>
<a class="sourceLine" id="cb72-6" title="6"><span class="kw">make_barplot_on_synergy_subset_stats</span>(synergy.subset.stats,</a>
<a class="sourceLine" id="cb72-7" title="7">                                     <span class="dt">threshold.for.subset.removal =</span> <span class="dv">1</span>, </a>
<a class="sourceLine" id="cb72-8" title="8">                                     <span class="dt">bottom.margin =</span> <span class="dv">6</span>, cell.line)</a></code></pre></div>
<p><img src="AGS_model_analysis_files/figure-html/Synergy%20stats%202-1.png" width="672" /></p>
<p>From the above figure (where we excluded sets of synergies that were predicted
by no model by setting the <code>threshold.for.subset.removal</code> value to 1) we observe
that:</p>
<ul>
<li><strong>Almost half of the models predict none of the observed synergies</strong></li>
<li>The <code>PI-D1</code> synergy is predicted by almost all the rest of the models</li>
</ul>
<p>Next we calculate the maximum number of correctly predicted synergies (<span class="math inline">\(TP\)</span> -
True Positives) per model:</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb73-1" title="1"><span class="co"># Count the predictions of the observed synergies per model (TP)</span></a>
<a class="sourceLine" id="cb73-2" title="2">models.synergies.tp =<span class="st"> </span><span class="kw">calculate_models_synergies_tp</span>(observed.model.predictions)</a>
<a class="sourceLine" id="cb73-3" title="3">models.synergies.tp.stats =<span class="st"> </span><span class="kw">table</span>(models.synergies.tp)</a>
<a class="sourceLine" id="cb73-4" title="4"></a>
<a class="sourceLine" id="cb73-5" title="5"><span class="co"># Bar plot of number of models vs correctly predicted synergies</span></a>
<a class="sourceLine" id="cb73-6" title="6"><span class="kw">make_barplot_on_models_stats</span>(models.synergies.tp.stats, cell.line, </a>
<a class="sourceLine" id="cb73-7" title="7">                             <span class="dt">title =</span> <span class="st">&quot;True Positive Synergy Predictions&quot;</span>,</a>
<a class="sourceLine" id="cb73-8" title="8">                             <span class="dt">xlab =</span> <span class="st">&quot;Number of maximum correctly predicted synergies&quot;</span>,</a>
<a class="sourceLine" id="cb73-9" title="9">                             <span class="dt">ylab =</span> <span class="st">&quot;Number of models&quot;</span>)</a></code></pre></div>
<p><img src="AGS_model_analysis_files/figure-html/TP%20Stats-1.png" width="672" /></p>
<p>To summarize:</p>
<ul>
<li>There were <strong>405
models that predicted 2
synergies</strong> - the set <code>BI-D1,PI-D1</code> - which is the <strong>maximum number of predicted
synergies by an individual model</strong> and also the number of <strong>total predicted
synergies by all models together</strong></li>
</ul>
<p>The power of the ensemble model approach lies in the fact that (as
we saw from the above figures) even though we may not have <em>individual super models</em>
that can predict many observed drug combinations, there are many that predict
<em>at least one</em> and which will be used by the drug response analysis module
(<code>Drabme</code>) to better infer the synergistic drug combinations. It goes without
saying though, that the existance of models that could predict more than a
handful of synergies would be beneficial for any approach that performs drug
response analysis on a multitude of models.</p>
</div>
<div id="biomarker-analysis-1" class="section level2 unnumbered">
<h2>Biomarker analysis</h2>
<div id="intro-methods-1" class="section level3 unnumbered">
<h3>Intro-Methods</h3>
<p>Now, we want to investigate and find possible important nodes - <strong>biomarkers</strong> -
whose activity state either distinguishes good performance models from less
performant ones (in terms of a performance metric - e.g. the true positive
synergies predicted) or makes some models predict a specific synergy
compared to others that can’t (but could predict other synergies). So, we devised
<strong>two strategies</strong> to split the models in our disposal to <em>good</em> and <em>bad</em> ones
(but not necessarily all of them), the demarcation line being either a performance
metric (the number of <span class="math inline">\(TP\)</span> or the Matthews Correlation Coefficient score) or
the prediction or not of a specific synergy. Then, for
each group of models (labeled as either <em>good</em> or <em>bad</em>) we find the average
activity state of every node in the network (value between 0 and 1) and then we
compute the average state difference for each node between the two groups:
<span class="math inline">\(\forall i\in nodes,mean(state_i)_{good} - mean(state_i)_{bad}\)</span>.
Our hypothesis is that if the absolute value of these average differences are
larger than a <strong>user-defined threshold (e.g. 0.7)</strong> for a small number of nodes
(the less the better) while for the rest of the nodes they remain close to zero,
then the former nodes are considered <strong>the most important</strong> since they
define the difference between the <em>average bad model</em> and the <em>average good one</em>
in that particular case study. We will also deploy a network visualization method
to observe these average differences.</p>
</div>
<div id="true-positives-based-analysis-1" class="section level3 unnumbered">
<h3>True Positives-based analysis</h3>
<p>Using our first strategy, <strong>we will split the models based on the number of true
positive predictions</strong>. For example, the bad models will be the ones that
predicted 0 <span class="math inline">\(TP\)</span> synergies whereas the good models will be the ones that predicted
2 <span class="math inline">\(TP\)</span> (we will denote the grouping as <span class="math inline">\((0,2)\)</span>). This particular classification
strategy will be used for every possible combination of the number of <span class="math inline">\(TP\)</span> as
given by the <code>models.synergies.tp.stats</code> object and the density estimation of the
nodes’ average state differences in each case will be ploted in a common graph:</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" title="1">diff.tp.results =<span class="st"> </span><span class="kw">get_avg_activity_diff_mat_based_on_tp_predictions</span>(</a>
<a class="sourceLine" id="cb74-2" title="2">  models, models.synergies.tp, models.stable.state)</a>
<a class="sourceLine" id="cb74-3" title="3"></a>
<a class="sourceLine" id="cb74-4" title="4">tp.densities =<span class="st"> </span><span class="kw">apply</span>(<span class="kw">abs</span>(diff.tp.results), <span class="dv">1</span>, density)</a>
<a class="sourceLine" id="cb74-5" title="5"><span class="kw">make_multiple_density_plot</span>(tp.densities, <span class="dt">legend.title =</span> <span class="st">&quot;True Positives&quot;</span>, </a>
<a class="sourceLine" id="cb74-6" title="6">                           <span class="dt">x.axis.label =</span> <span class="st">&quot;Activity state (absolute difference value)&quot;</span>,</a>
<a class="sourceLine" id="cb74-7" title="7">                           <span class="dt">title =</span> <span class="st">&quot;Density Estimation for the Average State Difference&quot;</span>)</a></code></pre></div>
<p><img src="AGS_model_analysis_files/figure-html/Good%20vs%20Bad%20models%20based%20on%20the%20number%20of%20TPs-1.png" width="672" /></p>
<p>What we are actually looking for is density plots that are <em>largely skewed to
the right</em> (so the average absolute differences of these nodes are close to zero)
while there are a few areas of non-zero densities which are as close to 1 as
possible. So, from the above graph, the density plot that fits this description
is the one marked as <span class="math inline">\((1,2)\)</span>. We will visualize the nodes’
average state differences in a network graph <span class="citation">(Csardi and Nepusz <a href="references.html#ref-Csardi2006">2006</a>)</span>, where the color of each node will
denote how much more inhibited or active that node is, in the average good model
vs the average bad one. The color of the edges will denote activation (green) or
inhibition (red). We first build the network from the node topology (edge list):</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb75-1" title="1">parent.dir =<span class="st"> </span><span class="kw">get_parent_dir</span>(data.dir)</a>
<a class="sourceLine" id="cb75-2" title="2">topology.file =<span class="st"> </span><span class="kw">paste0</span>(parent.dir, <span class="st">&quot;/topology&quot;</span>)</a>
<a class="sourceLine" id="cb75-3" title="3">coordinates.file =<span class="st"> </span><span class="kw">paste0</span>(parent.dir, <span class="st">&quot;/network_xy_coordinates&quot;</span>)</a>
<a class="sourceLine" id="cb75-4" title="4"></a>
<a class="sourceLine" id="cb75-5" title="5">net =<span class="st"> </span><span class="kw">construct_network</span>(topology.file, models.dir)</a>
<a class="sourceLine" id="cb75-6" title="6"></a>
<a class="sourceLine" id="cb75-7" title="7"><span class="co"># a static layout for plotting the same network always (igraph)</span></a>
<a class="sourceLine" id="cb75-8" title="8"><span class="co"># nice.layout = layout_nicely(net)</span></a>
<a class="sourceLine" id="cb75-9" title="9">nice.layout =<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">read.table</span>(coordinates.file))</a></code></pre></div>
<p>In the next colored graphs we can identify the important nodes whose activity
state can influence the true positive prediction performance (from 0 true
positive synergies to a total of 2):</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb76-1" title="1"><span class="kw">plot_avg_state_diff_graph</span>(net, diff.tp.results[<span class="st">&quot;(0,1)&quot;</span>,], <span class="dt">layout =</span> nice.layout,</a>
<a class="sourceLine" id="cb76-2" title="2">                          <span class="dt">title =</span> <span class="st">&quot;Bad models (0 TP) vs Good models (1 TP)&quot;</span>)</a></code></pre></div>
<p><img src="AGS_model_analysis_files/figure-html/Graphs:%20Good%20vs%20Bad%20models%20based%20on%20the%20number%20of%20TPs-1.png" width="672" /></p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb77-1" title="1"><span class="kw">plot_avg_state_diff_graph</span>(net, diff.tp.results[<span class="st">&quot;(0,2)&quot;</span>,], <span class="dt">layout =</span> nice.layout,</a>
<a class="sourceLine" id="cb77-2" title="2">                          <span class="dt">title =</span> <span class="st">&quot;Bad models (0 TP) vs Good models (2 TP)&quot;</span>)</a></code></pre></div>
<p><img src="AGS_model_analysis_files/figure-html/Graphs:%20Good%20vs%20Bad%20models%20based%20on%20the%20number%20of%20TPs-2.png" width="672" /></p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" title="1"><span class="kw">plot_avg_state_diff_graph</span>(net, diff.tp.results[<span class="st">&quot;(1,2)&quot;</span>,], <span class="dt">layout =</span> nice.layout,</a>
<a class="sourceLine" id="cb78-2" title="2">                          <span class="dt">title =</span> <span class="st">&quot;Bad models (1 TP) vs Good models (2 TP)&quot;</span>)</a></code></pre></div>
<p><img src="AGS_model_analysis_files/figure-html/Graphs:%20Good%20vs%20Bad%20models%20based%20on%20the%20number%20of%20TPs-3.png" width="672" /></p>
<p>We will now <strong>list the important nodes</strong> that affect the models’ prediction
performance <strong>with regards to the number of true positive synergies</strong> that they
predict. Comparing the graphs above, we observe that there exist common nodes
that maintain the same significant influence in all of the graphs. We set the
<strong>threshold for the absolute significance level in average state differences
to <span class="math inline">\(0.7\)</span></strong>. A node will be marked as a biomarker (active or inhibited) if
its activity state difference surpassed the aforementioned threshold (positively
or negatively) <strong>for any of the tested groups</strong> (e.g. 1 <span class="math inline">\(TP\)</span> vs 2 <span class="math inline">\(TP\)</span>). We
observe <strong>that using the above threshold (which was also used in the other cell
lines), no biomarkers can be identified</strong>:</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb79-1" title="1">biomarkers.tp.active =<span class="st"> </span><span class="kw">get_biomarkers_per_type</span>(</a>
<a class="sourceLine" id="cb79-2" title="2">  diff.tp.results, <span class="dt">threshold =</span> <span class="fl">0.7</span>, <span class="dt">type =</span> <span class="st">&quot;positive&quot;</span></a>
<a class="sourceLine" id="cb79-3" title="3">)</a>
<a class="sourceLine" id="cb79-4" title="4">biomarkers.tp.inhibited =<span class="st"> </span><span class="kw">get_biomarkers_per_type</span>(</a>
<a class="sourceLine" id="cb79-5" title="5">  diff.tp.results, <span class="dt">threshold =</span> <span class="fl">0.7</span>, <span class="dt">type =</span> <span class="st">&quot;negative&quot;</span></a>
<a class="sourceLine" id="cb79-6" title="6">)</a>
<a class="sourceLine" id="cb79-7" title="7"></a>
<a class="sourceLine" id="cb79-8" title="8"><span class="kw">pretty_print_vector_values</span>(biomarkers.tp.active)</a></code></pre></div>
<blockquote>
<p>0 nodes:</p>
</blockquote>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb80-1" title="1"><span class="kw">pretty_print_vector_values</span>(biomarkers.tp.inhibited)</a></code></pre></div>
<blockquote>
<p>0 nodes:</p>
</blockquote>
<p>This happens mainly because of the low number of <span class="math inline">\(TP\)</span> synergies (larger number of
<span class="math inline">\(TP\)</span> would allow better performance classification). So, for this cell line, <strong>we
lower the significance threshold to <span class="math inline">\(0.6\)</span></strong> and thus identify these <em>active</em>
biomarkers:</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb81-1" title="1">biomarkers.tp.active =<span class="st"> </span><span class="kw">get_biomarkers_per_type</span>(</a>
<a class="sourceLine" id="cb81-2" title="2">  diff.tp.results, <span class="dt">threshold =</span> <span class="fl">0.6</span>, <span class="dt">type =</span> <span class="st">&quot;positive&quot;</span></a>
<a class="sourceLine" id="cb81-3" title="3">)</a>
<a class="sourceLine" id="cb81-4" title="4"><span class="kw">pretty_print_vector_values</span>(biomarkers.tp.active)</a></code></pre></div>
<blockquote>
<p>3 nodes: MAPK14, RPS6KA5, DUSP1</p>
</blockquote>
<p>The <em>inhibited</em> biomarkers that correspond to a <span class="math inline">\(0.6\)</span> threshold, are:</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" title="1">biomarkers.tp.inhibited =<span class="st"> </span><span class="kw">get_biomarkers_per_type</span>(</a>
<a class="sourceLine" id="cb82-2" title="2">  diff.tp.results, <span class="dt">threshold =</span> <span class="fl">0.6</span>, <span class="dt">type =</span> <span class="st">&quot;negative&quot;</span></a>
<a class="sourceLine" id="cb82-3" title="3">)</a>
<a class="sourceLine" id="cb82-4" title="4"><span class="kw">pretty_print_vector_values</span>(biomarkers.tp.inhibited)</a></code></pre></div>
<blockquote>
<p>7 nodes: FGFR1, TAB1, CASP3, EGFR, PTPN7, MAX, JNK</p>
</blockquote>
<p>We check if there are nodes found by our method as biomarkers in both active and
inhibited states:</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb83-1" title="1">common.biomarkers.tp =<span class="st"> </span></a>
<a class="sourceLine" id="cb83-2" title="2"><span class="st">  </span><span class="kw">get_common_values</span>(biomarkers.tp.active, biomarkers.tp.inhibited)</a></code></pre></div>
<blockquote>
<p>No common nodes</p>
</blockquote>
</div>
<div id="mcc-classification-based-analysis-1" class="section level3 unnumbered">
<h3>MCC classification-based analysis</h3>
<p>The previous method to split the models based on the number of true positive
predictions is a good metric for absolute performance but a very restricted one
since it ignores the other values of the confusion matrix for each model (true
negatives, false positives, false negatives). Also, since our dataset is
<em>imbalanced</em> in the sense that out of the total drug combinations tested only a
few of them are observed as synergistic (and in a hypothetical larger drug
screening evaluation it will be even less true positives) we will now devise a
method to split the models into different performance categories based on the
value of the <strong>Matthews Correlation Coefficient (MCC) score</strong> which takes into
account the balance ratios of all the four confusion matrix values:</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" title="1"><span class="co"># Calculate Matthews Correlation Coefficient (MCC) for every model</span></a>
<a class="sourceLine" id="cb84-2" title="2">models.mcc =<span class="st"> </span><span class="kw">calculate_models_mcc</span>(observed.model.predictions, </a>
<a class="sourceLine" id="cb84-3" title="3">                                  unobserved.model.predictions,</a>
<a class="sourceLine" id="cb84-4" title="4">                                  number.of.drug.comb.tested)</a>
<a class="sourceLine" id="cb84-5" title="5"></a>
<a class="sourceLine" id="cb84-6" title="6">models.mcc.stats =<span class="st"> </span><span class="kw">table</span>(models.mcc, <span class="dt">useNA =</span> <span class="st">&quot;ifany&quot;</span>)</a>
<a class="sourceLine" id="cb84-7" title="7"></a>
<a class="sourceLine" id="cb84-8" title="8"><span class="kw">make_barplot_on_models_stats</span>(models.mcc.stats, cell.line, <span class="dt">title =</span> <span class="st">&quot;MCC scores&quot;</span>, </a>
<a class="sourceLine" id="cb84-9" title="9">                             <span class="dt">xlab =</span> <span class="st">&quot;MCC value&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Number of models&quot;</span>, </a>
<a class="sourceLine" id="cb84-10" title="10">                             <span class="dt">cont.values =</span> <span class="ot">TRUE</span>, <span class="dt">threshold =</span> <span class="dv">42</span>)</a></code></pre></div>
<p><img src="AGS_model_analysis_files/figure-html/MCC%20Stats-1.png" width="864" /></p>
<p>Note that for presentation purposes in the figure above, we pruned some MCC-bars
with lower model frequency values. We observe that:</p>
<ul>
<li>There are no relatively bad models (MCC values close to -1)</li>
<li>Most of the models perform a little better than random prediction (<span class="math inline">\(MCC&gt;0\)</span>)</li>
<li>There are models that had <code>NaN</code> value for the MCC score (18 in total but we
pruned the bars corresponding to less than 42 models)</li>
</ul>
<p>Given the MCC formula:
<span class="math inline">\(MCC = (TP\cdot TN - FP\cdot FN)/\sqrt{(TP+FP) * (TP+FN) * (TN+FP) * (TN+FN)}\)</span>,
we can see that the MCC value can be <code>NaN</code> because of zero devision. Two of the
four values in the denominator represent the number of positive <span class="math inline">\((TP+FN)\)</span> and
negative <span class="math inline">\((TN+FP)\)</span> observations which are non-zero for every model, since they
correspond to the observed and non-obsered synergies in each case.
The case where both <span class="math inline">\(TN\)</span> and <span class="math inline">\(FN\)</span> are zero is rare (if non-existent)
because of the imbalanced dataset (large proportion of negatives) and the reason
that logical models which report no negatives means that they should find
fixpoint attractors for every possible drug combination perturbation which also
is extremely unlikely. We can actually see that the <code>NaN</code> are produced by models
that have <strong>both TP and FP equal to zero</strong>:</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb85-1" title="1">models.synergies.fp =<span class="st"> </span><span class="kw">calculate_models_synergies_fp</span>(unobserved.model.predictions)</a>
<a class="sourceLine" id="cb85-2" title="2"><span class="kw">pretty_print_string</span>(<span class="kw">sum</span>(models.synergies.tp <span class="op">+</span><span class="st"> </span>models.synergies.fp <span class="op">==</span><span class="st"> </span><span class="dv">0</span>))</a></code></pre></div>
<blockquote>
<p>18</p>
</blockquote>
<p>Since these models could intentify no synergies (either correctly or
wrongly), we decided to put them <strong>as the lowest performant category</strong> in our
MCC-based analysis. To classify the models based on their MCC score (which takes
values in the <span class="math inline">\([-1, 1]\)</span> interval, <code>NaN</code> values excluded), we will perform a
<em>univariate k-means clustering</em> to <strong>split the previously found MCC values to
different classes</strong> <span class="citation">(Wang and Song <a href="references.html#ref-Wang2011">2011</a>)</span>. The MCC classification is presented with a histogram:</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb86-1" title="1">num.of.classes =<span class="st"> </span><span class="dv">5</span></a>
<a class="sourceLine" id="cb86-2" title="2">mcc.class.ids =<span class="st"> </span><span class="dv">1</span><span class="op">:</span>num.of.classes</a>
<a class="sourceLine" id="cb86-3" title="3"></a>
<a class="sourceLine" id="cb86-4" title="4">models.mcc.no.nan =<span class="st"> </span>models.mcc[<span class="op">!</span><span class="kw">is.nan</span>(models.mcc)]</a>
<a class="sourceLine" id="cb86-5" title="5">models.mcc.no.nan.sorted =<span class="st"> </span><span class="kw">sort</span>(models.mcc.no.nan)</a>
<a class="sourceLine" id="cb86-6" title="6"></a>
<a class="sourceLine" id="cb86-7" title="7"><span class="co"># find the clusters</span></a>
<a class="sourceLine" id="cb86-8" title="8">res =<span class="st"> </span><span class="kw">Ckmeans.1d.dp</span>(<span class="dt">x =</span> models.mcc.no.nan.sorted, <span class="dt">k =</span> num.of.classes)</a>
<a class="sourceLine" id="cb86-9" title="9">models.cluster.ids =<span class="st"> </span>res<span class="op">$</span>cluster</a>
<a class="sourceLine" id="cb86-10" title="10"></a>
<a class="sourceLine" id="cb86-11" title="11"><span class="kw">plot_mcc_classes_hist</span>(models.mcc.no.nan.sorted, models.cluster.ids,</a>
<a class="sourceLine" id="cb86-12" title="12">                      num.of.classes, mcc.class.ids)</a></code></pre></div>
<p><img src="AGS_model_analysis_files/figure-html/MCC%20clasification-1.png" width="672" /></p>
<p>Note that in total we will have <strong>5 MCC classes</strong> in our subsequent analysis,
excluding the <code>NaN</code> MCC class, because of the small number of models (18) that
belong to this class compared to the other MCC class sizes.</p>
<p>Following our first strategy, <strong>we will split the models based on the MCC
performance metric score</strong>. For example, the bad models will be the ones that
had an MCC score belonging to the first MCC class whereas the good models will
be the ones that had an MCC score belonging to the third MCC class as seen in
the histogram above. This particular classification strategy will be used for
every possible combination of the MCC classes and the density estimation of the
nodes’ average state differences in each case will be ploted in a common graph:</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb87-1" title="1">mcc.class.id.comb =<span class="st"> </span><span class="kw">t</span>(<span class="kw">combn</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(mcc.class.ids), <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb87-2" title="2"></a>
<a class="sourceLine" id="cb87-3" title="3">diff.mcc.results =<span class="st"> </span><span class="kw">apply</span>(mcc.class.id.comb, <span class="dv">1</span>, <span class="cf">function</span>(comb) {</a>
<a class="sourceLine" id="cb87-4" title="4">  <span class="kw">return</span>(<span class="kw">get_avg_activity_diff_based_on_mcc_clustering</span>(</a>
<a class="sourceLine" id="cb87-5" title="5">          models.mcc, models.stable.state,</a>
<a class="sourceLine" id="cb87-6" title="6">          mcc.class.ids, models.cluster.ids, </a>
<a class="sourceLine" id="cb87-7" title="7">          <span class="dt">class.id.low =</span> comb[<span class="dv">1</span>], <span class="dt">class.id.high =</span> comb[<span class="dv">2</span>]))</a>
<a class="sourceLine" id="cb87-8" title="8">})</a>
<a class="sourceLine" id="cb87-9" title="9"></a>
<a class="sourceLine" id="cb87-10" title="10">mcc.classes.comb.names =<span class="st"> </span><span class="kw">apply</span>(mcc.class.id.comb, <span class="dv">1</span>, <span class="cf">function</span>(comb) {</a>
<a class="sourceLine" id="cb87-11" title="11">  <span class="kw">return</span>(<span class="kw">paste0</span>(<span class="st">&quot;(&quot;</span>, mcc.class.ids[comb[<span class="dv">1</span>]], <span class="st">&quot;,&quot;</span>, mcc.class.ids[comb[<span class="dv">2</span>]], <span class="st">&quot;)&quot;</span>))</a>
<a class="sourceLine" id="cb87-12" title="12">})</a>
<a class="sourceLine" id="cb87-13" title="13"></a>
<a class="sourceLine" id="cb87-14" title="14"><span class="kw">colnames</span>(diff.mcc.results) =<span class="st"> </span>mcc.classes.comb.names</a>
<a class="sourceLine" id="cb87-15" title="15">diff.mcc.results =<span class="st"> </span><span class="kw">t</span>(diff.mcc.results)</a>
<a class="sourceLine" id="cb87-16" title="16"></a>
<a class="sourceLine" id="cb87-17" title="17">mcc.densities =<span class="st"> </span><span class="kw">apply</span>(<span class="kw">abs</span>(diff.mcc.results), <span class="dv">1</span>, density)</a>
<a class="sourceLine" id="cb87-18" title="18"><span class="kw">make_multiple_density_plot</span>(mcc.densities, <span class="dt">legend.title =</span> <span class="st">&quot;MCC classes&quot;</span>,</a>
<a class="sourceLine" id="cb87-19" title="19">                           <span class="dt">x.axis.label =</span> <span class="st">&quot;Activity state (absolute difference value)&quot;</span>,</a>
<a class="sourceLine" id="cb87-20" title="20">                           <span class="dt">title =</span> <span class="st">&quot;Density Estimation for the Average State Difference&quot;</span>)</a></code></pre></div>
<p><img src="AGS_model_analysis_files/figure-html/Good%20vs%20Bad%20models%20based%20on%20the%20MCC%20classification-1.png" width="672" /></p>
<p>Many of the density plots above are of interest to us, since they are <em>right
skewed</em>. Next, we visualize the average state differences with our network
coloring method for 2 of the above cases, in order to identify the important
nodes whose activity state can influence the prediction performance based on
the MCC classification:</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb88-1" title="1"><span class="kw">plot_avg_state_diff_graph</span>(net, diff.mcc.results[<span class="st">&quot;(3,4)&quot;</span>,], <span class="dt">layout =</span> nice.layout, </a>
<a class="sourceLine" id="cb88-2" title="2">             <span class="dt">title =</span> <span class="st">&quot;Bad models (MCC Class: 3) vs Good models (MCC Class: 4)&quot;</span>)</a></code></pre></div>
<p><img src="AGS_model_analysis_files/figure-html/Graphs:%20Good%20vs%20Bad%20models%20based%20on%20the%20MCC%20classification-1.png" width="672" /></p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb89-1" title="1"><span class="kw">plot_avg_state_diff_graph</span>(net, diff.mcc.results[<span class="st">&quot;(2,5)&quot;</span>,], <span class="dt">layout =</span> nice.layout, </a>
<a class="sourceLine" id="cb89-2" title="2">             <span class="dt">title =</span> <span class="st">&quot;Bad models (MCC Class: 2) vs Good models (MCC Class: 5)&quot;</span>)</a></code></pre></div>
<p><img src="AGS_model_analysis_files/figure-html/Graphs:%20Good%20vs%20Bad%20models%20based%20on%20the%20MCC%20classification-2.png" width="672" /></p>
<p>We will now <strong>list the important nodes</strong> that affect the models’ prediction
performance <strong>with regards to their MCC classification</strong>, using the same method
as in the <code>True Positives-based analysis</code> section. First, the nodes that have to
be in a more <em>active</em> state:</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb90-1" title="1">biomarkers.mcc.active =<span class="st"> </span><span class="kw">get_biomarkers_per_type</span>(</a>
<a class="sourceLine" id="cb90-2" title="2">  diff.mcc.results, <span class="dt">threshold =</span> <span class="fl">0.7</span>, <span class="dt">type =</span> <span class="st">&quot;positive&quot;</span></a>
<a class="sourceLine" id="cb90-3" title="3">)</a>
<a class="sourceLine" id="cb90-4" title="4"><span class="kw">pretty_print_vector_values</span>(biomarkers.mcc.active)</a></code></pre></div>
<blockquote>
<p>3 nodes: MAPK14, RPS6KA5, DUSP1</p>
</blockquote>
<p>Secondly, the nodes that have to be in a more <em>inhibited</em> state:</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb91-1" title="1">biomarkers.mcc.inhibited =<span class="st"> </span><span class="kw">get_biomarkers_per_type</span>(</a>
<a class="sourceLine" id="cb91-2" title="2">  diff.mcc.results, <span class="dt">threshold =</span> <span class="fl">0.7</span>, <span class="dt">type =</span> <span class="st">&quot;negative&quot;</span></a>
<a class="sourceLine" id="cb91-3" title="3">)</a>
<a class="sourceLine" id="cb91-4" title="4"><span class="kw">pretty_print_vector_values</span>(biomarkers.mcc.inhibited)</a></code></pre></div>
<blockquote>
<p>7 nodes: FGFR1, TAB1, CASP3, EGFR, PTPN7, MAX, JNK</p>
</blockquote>
<p>We check if there are nodes found by our method as biomarkers in both active and
inhibited states:</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb92-1" title="1">common.biomarkers.mcc =<span class="st"> </span></a>
<a class="sourceLine" id="cb92-2" title="2"><span class="st">  </span><span class="kw">get_common_values</span>(biomarkers.mcc.active, biomarkers.mcc.inhibited)</a></code></pre></div>
<blockquote>
<p>No common nodes</p>
</blockquote>
</div>
<div id="performance-related-biomarkers-1" class="section level3 unnumbered">
<h3>Performance-related biomarkers</h3>
<p>Comparing the two methods we used for the classification of the models’ prediction
performance (TP and MCC), we observe that there exist <strong>common biomarkers</strong> in
both active and inhibited state cases. Also we note that there weren’t any common
nodes reported as significantly active in one method which were significantly
inhibited in the other, showing that the two methods’ results correlate well:</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb93-1" title="1">common.biomarkers.mixed<span class="fl">.1</span> =<span class="st"> </span></a>
<a class="sourceLine" id="cb93-2" title="2"><span class="st">  </span><span class="kw">get_common_values</span>(biomarkers.mcc.active, biomarkers.tp.inhibited)</a></code></pre></div>
<blockquote>
<p>No common nodes</p>
</blockquote>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb94-1" title="1">common.biomarkers.mixed<span class="fl">.2</span> =<span class="st"> </span></a>
<a class="sourceLine" id="cb94-2" title="2"><span class="st">  </span><span class="kw">get_common_values</span>(biomarkers.mcc.inhibited, biomarkers.tp.active)</a></code></pre></div>
<blockquote>
<p>No common nodes</p>
</blockquote>
<p>To sum up, we list the common biomarkers that need to be in a more <em>active</em>
state:</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb95-1" title="1">biomarkers.perf.active =</a>
<a class="sourceLine" id="cb95-2" title="2"><span class="st">  </span><span class="kw">get_common_values</span>(biomarkers.mcc.active, biomarkers.tp.active)</a></code></pre></div>
<blockquote>
<p>3 nodes: MAPK14, RPS6KA5, DUSP1</p>
</blockquote>
<p>We also list the common nodes that have to be in a more <em>inhibited</em> state:</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb96-1" title="1">biomarkers.perf.inhibited =</a>
<a class="sourceLine" id="cb96-2" title="2"><span class="st">  </span><span class="kw">get_common_values</span>(biomarkers.mcc.inhibited, biomarkers.tp.inhibited)</a></code></pre></div>
<blockquote>
<p>7 nodes: FGFR1, TAB1, CASP3, EGFR, PTPN7, MAX, JNK</p>
</blockquote>
<p>Lastly, we will save these common performance-related biomarkers for further
analysis and comparison with the results from all the different cell lines:</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb97-1" title="1">biomarkers.dir =<span class="st"> </span><span class="kw">paste0</span>(data.dir, <span class="st">&quot;biomarkers/&quot;</span>)</a>
<a class="sourceLine" id="cb97-2" title="2"><span class="kw">save_vector_to_file</span>(<span class="dt">vector =</span> biomarkers.perf.active,</a>
<a class="sourceLine" id="cb97-3" title="3">                    <span class="dt">file =</span> <span class="kw">paste0</span>(biomarkers.dir, <span class="st">&quot;biomarkers_active&quot;</span>))</a>
<a class="sourceLine" id="cb97-4" title="4"><span class="kw">save_vector_to_file</span>(<span class="dt">vector =</span> biomarkers.perf.inhibited,</a>
<a class="sourceLine" id="cb97-5" title="5">                    <span class="dt">file =</span> <span class="kw">paste0</span>(biomarkers.dir, <span class="st">&quot;biomarkers_inhibited&quot;</span>))</a></code></pre></div>
</div>
<div id="equation-based-analysis-1" class="section level3 unnumbered">
<h3>Equation-based analysis</h3>
<p>It will be interesting to see the different patterns in the form of the boolean
equations (regarding the mutation of the <em>link operator</em> as mentioned in the <code>Input</code>
section) when comparing higher performance models vs the low performant ones. We
could also check if any of the biomarkers found above relate to a different link
operator on average between models with different performance characteristics
(e.g. higher predictive models should have the <code>OR NOT</code> as the link operator in
a boolean equation where a specific biomarker is the regulation target) or if they
constitute targets of exclusively activating nodes or inhibiting ones (an equation
with no link operator).</p>
<p>The performance metric we will first use to sort the models is the number of true
positive predictions. We will now illustrate the heatmap of the <code>models.equations</code>
object raw-order by the number of <span class="math inline">\(TP\)</span> predictions:</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb98-1" title="1"><span class="co"># order based on number of true positives</span></a>
<a class="sourceLine" id="cb98-2" title="2">models.synergies.tp.sorted =<span class="st"> </span><span class="kw">sort</span>(models.synergies.tp)</a>
<a class="sourceLine" id="cb98-3" title="3">models.sorted =<span class="st"> </span><span class="kw">names</span>(models.synergies.tp.sorted)</a>
<a class="sourceLine" id="cb98-4" title="4">models.equations.sorted =<span class="st"> </span>models.equations[models.sorted, ]</a>
<a class="sourceLine" id="cb98-5" title="5"></a>
<a class="sourceLine" id="cb98-6" title="6"><span class="co"># coloring</span></a>
<a class="sourceLine" id="cb98-7" title="7">eq.link.colors =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;lightyellow&quot;</span>)</a>
<a class="sourceLine" id="cb98-8" title="8">eq.link.col.fun =<span class="st"> </span><span class="kw">colorRamp2</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">colors =</span> eq.link.colors)</a>
<a class="sourceLine" id="cb98-9" title="9">tp.values =<span class="st"> </span><span class="kw">sort</span>(<span class="kw">unique</span>(models.synergies.tp))</a>
<a class="sourceLine" id="cb98-10" title="10">tp.col.fun =<span class="st"> </span><span class="kw">colorRamp2</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="kw">min</span>(tp.values), <span class="kw">max</span>(tp.values)), </a>
<a class="sourceLine" id="cb98-11" title="11">                         <span class="dt">colors =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;green&quot;</span>))</a>
<a class="sourceLine" id="cb98-12" title="12"></a>
<a class="sourceLine" id="cb98-13" title="13"><span class="co"># color biomarker names in the heatmap</span></a>
<a class="sourceLine" id="cb98-14" title="14">bottom.nodes.colors =<span class="st"> </span><span class="kw">rep</span>(<span class="st">&quot;black&quot;</span>, <span class="kw">length</span>(<span class="kw">colnames</span>(models.equations.sorted)))</a>
<a class="sourceLine" id="cb98-15" title="15"><span class="kw">names</span>(bottom.nodes.colors) =<span class="st"> </span><span class="kw">colnames</span>(models.equations.sorted)</a>
<a class="sourceLine" id="cb98-16" title="16">bottom.nodes.colors[<span class="kw">names</span>(bottom.nodes.colors) <span class="op">%in%</span></a>
<a class="sourceLine" id="cb98-17" title="17"><span class="st">                    </span>biomarkers.perf.active] =<span class="st"> &quot;blue&quot;</span></a>
<a class="sourceLine" id="cb98-18" title="18">bottom.nodes.colors[<span class="kw">names</span>(bottom.nodes.colors) <span class="op">%in%</span></a>
<a class="sourceLine" id="cb98-19" title="19"><span class="st">                    </span>biomarkers.perf.inhibited] =<span class="st"> &quot;magenta&quot;</span></a>
<a class="sourceLine" id="cb98-20" title="20"></a>
<a class="sourceLine" id="cb98-21" title="21"><span class="co"># define the TP color bar</span></a>
<a class="sourceLine" id="cb98-22" title="22">tp.annot =<span class="st"> </span><span class="kw">rowAnnotation</span>(</a>
<a class="sourceLine" id="cb98-23" title="23">  <span class="dt">tp =</span> <span class="kw">anno_simple</span>(<span class="dt">x =</span> models.synergies.tp.sorted, <span class="dt">col =</span> tp.col.fun), </a>
<a class="sourceLine" id="cb98-24" title="24">  <span class="dt">show_annotation_name =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb98-25" title="25"></a>
<a class="sourceLine" id="cb98-26" title="26">heatmap.eq =<span class="st"> </span></a>
<a class="sourceLine" id="cb98-27" title="27"><span class="st">  </span><span class="kw">Heatmap</span>(<span class="dt">matrix =</span> models.equations.sorted, <span class="dt">column_title =</span> <span class="st">&quot;Models Link Operators&quot;</span>,</a>
<a class="sourceLine" id="cb98-28" title="28">    <span class="dt">column_title_gp =</span> <span class="kw">gpar</span>(<span class="dt">fontsize =</span> <span class="dv">20</span>), <span class="dt">row_title =</span> <span class="st">&quot;Models (TP sorted)&quot;</span>,</a>
<a class="sourceLine" id="cb98-29" title="29">    <span class="dt">cluster_rows =</span> <span class="ot">FALSE</span>, <span class="dt">show_row_names =</span> <span class="ot">FALSE</span>, <span class="dt">show_heatmap_legend =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb98-30" title="30">    <span class="dt">column_dend_height =</span> <span class="kw">unit</span>(<span class="dv">1</span>, <span class="st">&quot;inches&quot;</span>), <span class="dt">col =</span> eq.link.col.fun, </a>
<a class="sourceLine" id="cb98-31" title="31">    <span class="dt">column_names_gp =</span> <span class="kw">gpar</span>(<span class="dt">fontsize =</span> <span class="dv">9</span>, <span class="dt">col =</span> bottom.nodes.colors),  </a>
<a class="sourceLine" id="cb98-32" title="32">    <span class="dt">left_annotation =</span> tp.annot,</a>
<a class="sourceLine" id="cb98-33" title="33">    <span class="dt">use_raster =</span> <span class="ot">TRUE</span>, <span class="dt">raster_device =</span> <span class="st">&quot;png&quot;</span>, <span class="dt">raster_quality =</span> <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb98-34" title="34"></a>
<a class="sourceLine" id="cb98-35" title="35"><span class="co"># define the 3 legends</span></a>
<a class="sourceLine" id="cb98-36" title="36">link.op.legend =<span class="st"> </span><span class="kw">Legend</span>(<span class="dt">title =</span> <span class="st">&quot;Link Operator&quot;</span>, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;AND&quot;</span>, <span class="st">&quot;OR&quot;</span>), </a>
<a class="sourceLine" id="cb98-37" title="37">                        <span class="dt">legend_gp =</span> <span class="kw">gpar</span>(<span class="dt">fill =</span> eq.link.colors))</a>
<a class="sourceLine" id="cb98-38" title="38">tp.values =<span class="st"> </span><span class="kw">min</span>(tp.values)<span class="op">:</span><span class="kw">max</span>(tp.values) <span class="co"># maybe some integers are missing</span></a>
<a class="sourceLine" id="cb98-39" title="39">tp.legend =<span class="st"> </span><span class="kw">Legend</span>(<span class="dt">at =</span> tp.values, <span class="dt">title =</span> <span class="st">&quot;TP&quot;</span>, </a>
<a class="sourceLine" id="cb98-40" title="40">                   <span class="dt">legend_gp =</span> <span class="kw">gpar</span>(<span class="dt">fill =</span> <span class="kw">tp.col.fun</span>(tp.values)))</a>
<a class="sourceLine" id="cb98-41" title="41">biomarkers.legend =<span class="st"> </span><span class="kw">Legend</span>(<span class="dt">title =</span> <span class="st">&quot;Biomarkers&quot;</span>, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Inhibited&quot;</span>, <span class="st">&quot;Active&quot;</span>), </a>
<a class="sourceLine" id="cb98-42" title="42">                           <span class="dt">legend_gp =</span> <span class="kw">gpar</span>(<span class="dt">fill =</span> <span class="kw">c</span>(<span class="st">&quot;magenta&quot;</span>, <span class="st">&quot;blue&quot;</span>)))</a>
<a class="sourceLine" id="cb98-43" title="43">legend.list =<span class="st"> </span><span class="kw">packLegend</span>(link.op.legend, tp.legend, biomarkers.legend,</a>
<a class="sourceLine" id="cb98-44" title="44">                         <span class="dt">direction =</span> <span class="st">&quot;vertical&quot;</span>)</a>
<a class="sourceLine" id="cb98-45" title="45"></a>
<a class="sourceLine" id="cb98-46" title="46"><span class="kw">draw</span>(heatmap.eq, <span class="dt">annotation_legend_list =</span> legend.list, </a>
<a class="sourceLine" id="cb98-47" title="47">     <span class="dt">annotation_legend_side =</span> <span class="st">&quot;right&quot;</span>)</a></code></pre></div>
<p><img src="AGS_model_analysis_files/figure-html/Equation%20Heatmap%20(TP%20raw-ordered)-1.png" width="2100" /></p>
<p>In the heatmap above, an equation whose link operator is <code>AND NOT</code> is represented
with red color while an <code>OR NOT</code> link operator is represented with light yellow color.
The targets whose equations do not have a link operator are not represented.
The rows are ordered by the number of true positive predictions (ascending).
We have colored the names of the network nodes that were also found as biomarkers
(green color is used for the active biomarkers and red color for the inhibited
biomarkers). We observe that:</p>
<ul>
<li><strong>Most of the biomarkers are nodes that do not have both activators and inhibitors</strong>
and so are absent from the above heatmap</li>
<li>There doesn’t seem to exist a pattern between the models’ link operators
and their corresponding performance (at least not for all of the nodes) when using
the true positive predictions as a classifier for the models</li>
<li>There exist a lot of target nodes that need to have the <code>OR NOT</code> link operator
in their respective boolean equation in order for the corresponding logical model
to show a higher number of true positive predictions. By assigning the <code>OR NOT</code>
link operator to a target’s boolean regulation equation, we allow more flexibility
to the target’s output active result state - meaning that the inhibitors play less
role and the output state has a higher probability of being active - compared to
assigning the <code>AND NOT</code> link operator to the equation</li>
</ul>
<p>We will also illustrate the heatmap of the <code>models.equations</code> object raw-order
by the MCC score which is a better performance classifier. Models who had a <code>NaN</code>
MCC score will be again placed in the lower performant category:</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb99-1" title="1"><span class="co"># order based on the MCC value</span></a>
<a class="sourceLine" id="cb99-2" title="2">models.mcc.sorted =<span class="st"> </span><span class="kw">sort</span>(models.mcc, <span class="dt">na.last =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb99-3" title="3">models.sorted =<span class="st"> </span><span class="kw">names</span>(models.mcc.sorted)</a>
<a class="sourceLine" id="cb99-4" title="4">models.equations.sorted =<span class="st"> </span>models.equations[models.sorted, ]</a>
<a class="sourceLine" id="cb99-5" title="5"></a>
<a class="sourceLine" id="cb99-6" title="6"><span class="co"># coloring</span></a>
<a class="sourceLine" id="cb99-7" title="7">mcc.col.fun =<span class="st"> </span></a>
<a class="sourceLine" id="cb99-8" title="8"><span class="st">  </span><span class="kw">colorRamp2</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="kw">min</span>(models.mcc.no.nan),</a>
<a class="sourceLine" id="cb99-9" title="9">                        <span class="kw">max</span>(models.mcc.no.nan)), <span class="dt">colors =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;green&quot;</span>))</a>
<a class="sourceLine" id="cb99-10" title="10"></a>
<a class="sourceLine" id="cb99-11" title="11"><span class="co"># define the MCC color bar</span></a>
<a class="sourceLine" id="cb99-12" title="12">mcc.annot =<span class="st"> </span><span class="kw">rowAnnotation</span>(</a>
<a class="sourceLine" id="cb99-13" title="13">  <span class="dt">mcc =</span> <span class="kw">anno_simple</span>(<span class="dt">x =</span> models.mcc.sorted, <span class="dt">col =</span> mcc.col.fun, <span class="dt">na_col =</span> <span class="st">&quot;black&quot;</span>), </a>
<a class="sourceLine" id="cb99-14" title="14">  <span class="dt">show_annotation_name =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb99-15" title="15"></a>
<a class="sourceLine" id="cb99-16" title="16">heatmap.eq =<span class="st"> </span></a>
<a class="sourceLine" id="cb99-17" title="17"><span class="st">  </span><span class="kw">Heatmap</span>(<span class="dt">matrix =</span> models.equations.sorted, <span class="dt">column_title =</span> <span class="st">&quot;Models Link Operators&quot;</span>,</a>
<a class="sourceLine" id="cb99-18" title="18">    <span class="dt">column_title_gp =</span> <span class="kw">gpar</span>(<span class="dt">fontsize =</span> <span class="dv">20</span>), <span class="dt">row_title =</span> <span class="st">&quot;Models (MCC sorted)&quot;</span>,</a>
<a class="sourceLine" id="cb99-19" title="19">    <span class="dt">cluster_rows =</span> <span class="ot">FALSE</span>, <span class="dt">show_row_names =</span> <span class="ot">FALSE</span>, <span class="dt">show_heatmap_legend =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb99-20" title="20">    <span class="dt">column_dend_height =</span> <span class="kw">unit</span>(<span class="dv">1</span>, <span class="st">&quot;inches&quot;</span>), <span class="dt">col =</span> eq.link.col.fun, </a>
<a class="sourceLine" id="cb99-21" title="21">    <span class="dt">column_names_gp =</span> <span class="kw">gpar</span>(<span class="dt">fontsize =</span> <span class="dv">9</span>, <span class="dt">col =</span> bottom.nodes.colors),  </a>
<a class="sourceLine" id="cb99-22" title="22">    <span class="dt">left_annotation =</span> mcc.annot,</a>
<a class="sourceLine" id="cb99-23" title="23">    <span class="dt">use_raster =</span> <span class="ot">TRUE</span>, <span class="dt">raster_device =</span> <span class="st">&quot;png&quot;</span>, <span class="dt">raster_quality =</span> <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb99-24" title="24"></a>
<a class="sourceLine" id="cb99-25" title="25"><span class="co"># define the 4 legends</span></a>
<a class="sourceLine" id="cb99-26" title="26">link.op.legend =<span class="st"> </span><span class="kw">Legend</span>(<span class="dt">title =</span> <span class="st">&quot;Link Operator&quot;</span>, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;AND&quot;</span>, <span class="st">&quot;OR&quot;</span>), </a>
<a class="sourceLine" id="cb99-27" title="27">                        <span class="dt">legend_gp =</span> <span class="kw">gpar</span>(<span class="dt">fill =</span> eq.link.colors))</a>
<a class="sourceLine" id="cb99-28" title="28">mcc.legend =<span class="st"> </span><span class="kw">Legend</span>(<span class="dt">title =</span> <span class="st">&quot;MCC&quot;</span>, <span class="dt">col_fun =</span> mcc.col.fun)</a>
<a class="sourceLine" id="cb99-29" title="29">na.legend =<span class="st"> </span><span class="kw">Legend</span>(<span class="dt">labels =</span> <span class="st">&quot;NA&quot;</span>, <span class="dt">legend_gp =</span> <span class="kw">gpar</span>(<span class="dt">fill =</span> <span class="st">&quot;black&quot;</span>))</a>
<a class="sourceLine" id="cb99-30" title="30">biomarkers.legend =<span class="st"> </span><span class="kw">Legend</span>(<span class="dt">title =</span> <span class="st">&quot;Biomarkers&quot;</span>, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Inhibited&quot;</span>, <span class="st">&quot;Active&quot;</span>), </a>
<a class="sourceLine" id="cb99-31" title="31">                           <span class="dt">legend_gp =</span> <span class="kw">gpar</span>(<span class="dt">fill =</span> <span class="kw">c</span>(<span class="st">&quot;magenta&quot;</span>, <span class="st">&quot;blue&quot;</span>)))</a>
<a class="sourceLine" id="cb99-32" title="32">legend.list =<span class="st"> </span><span class="kw">packLegend</span>(link.op.legend, mcc.legend, na.legend, biomarkers.legend,</a>
<a class="sourceLine" id="cb99-33" title="33">                         <span class="dt">direction =</span> <span class="st">&quot;vertical&quot;</span>)</a>
<a class="sourceLine" id="cb99-34" title="34"></a>
<a class="sourceLine" id="cb99-35" title="35"><span class="kw">draw</span>(heatmap.eq, <span class="dt">annotation_legend_list =</span> legend.list, </a>
<a class="sourceLine" id="cb99-36" title="36">     <span class="dt">annotation_legend_side =</span> <span class="st">&quot;right&quot;</span>)</a></code></pre></div>
<p><img src="AGS_model_analysis_files/figure-html/Equation%20Heatmap%20(MCC%20raw-ordered)-1.png" width="2100" /></p>
<p>In the MCC-ordered heatmap above we observe that there is <strong>better correlation
between the boolean equations’ link operators and the performance of a model</strong>
compared to the <span class="math inline">\(TP\)</span> classification. For example, the biomarkers <code>EGFR</code> and
<code>MAPK14</code> show distinguished patterns for the higher performance models
(use of <code>AND NOT</code> and <code>OR NOT</code> link operators respectively) when the models are
sorted by the MCC score.</p>
</div>
<div id="synergy-prediction-based-analysis-1" class="section level3 unnumbered">
<h3>Synergy-prediction based analysis</h3>
<p>We will now use the second strategy to split the models, based on whether
they predict a specific observed synergy or not. This will allow us
to <strong>find biomarkers that affect the prediction of a specific synergy</strong>.
For example, the good models could be the ones that predicted the hypothetical
synergy <code>A-B</code> while the bad models all the rest that identified the particular
combination as non-synergistic.
In another case scenario, the good models could be those that predicted a
triple synergy set <code>A-B,C-D,A-C</code>, while the bad models could be the ones
that predicted the double synergy subset <code>A-B,C-D</code> (excluding the common models
that predicted both the triple synergy set and subsequently its given subset).
In such a case scenario, we want to find out which nodes are responsible for making
the good models <strong>predict the extra synergy</strong> - in this hypothetical case the
synergy <code>A-C</code> - demonstrating thus better model performance. Note that the models
selected in each case as good or bad, could have predicted other synergies as well
(correctly as <span class="math inline">\(TP\)</span> or wrongly as <span class="math inline">\(FP\)</span>) which means that the biomarker selection
method could be somewhat innacurate, since we can’t really know the prediction of
which extra synergy or synergies the biomarkers’ state affected. To account for
this, we label as good models those that predict large synergy sets (so fewer
models) which capture almost all the true positive predictions and also minimize
the possible extra different synergies predicted by models of the same classification
category (e.g. the good models).</p>
<p>Starting with the first model classification method (prediction vs non-prediction
of a particular synergy), we generate the density distribution of the nodes’
average state differences between the good and bad models for each predicted synergy:</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb100-1" title="1">diff.predicted.synergies.results =<span class="st"> </span></a>
<a class="sourceLine" id="cb100-2" title="2"><span class="st">  </span><span class="kw">sapply</span>(predicted.synergies, <span class="cf">function</span>(drug.comb) {</a>
<a class="sourceLine" id="cb100-3" title="3">    <span class="kw">get_avg_activity_diff_based_on_specific_synergy_prediction</span>(</a>
<a class="sourceLine" id="cb100-4" title="4">      model.predictions, models.stable.state, drug.comb)</a>
<a class="sourceLine" id="cb100-5" title="5">  })</a>
<a class="sourceLine" id="cb100-6" title="6">diff.predicted.synergies.results =<span class="st"> </span><span class="kw">t</span>(diff.predicted.synergies.results)</a>
<a class="sourceLine" id="cb100-7" title="7"></a>
<a class="sourceLine" id="cb100-8" title="8">densities =<span class="st"> </span><span class="kw">apply</span>(<span class="kw">abs</span>(diff.predicted.synergies.results), <span class="dv">1</span>, density)</a>
<a class="sourceLine" id="cb100-9" title="9"><span class="kw">make_multiple_density_plot</span>(densities, <span class="dt">legend.title =</span> <span class="st">&quot;Predicted Synergies&quot;</span>,</a>
<a class="sourceLine" id="cb100-10" title="10">                           <span class="dt">x.axis.label =</span> <span class="st">&quot;Activity state (absolute difference value)&quot;</span>,</a>
<a class="sourceLine" id="cb100-11" title="11">                           <span class="dt">title =</span> <span class="st">&quot;Density Estimation for the Average State Difference&quot;</span>)</a></code></pre></div>
<p><img src="AGS_model_analysis_files/figure-html/Good%20vs%20Bad%20models%20based%20on%20a%20specific%20synergy%20prediction-1.png" width="672" /></p>
<p>Next, we will plot the biomarkers with the network visualization method (for all
predicted synergies) and output the respective biomarkers in each case.
The biomarker results for each predicted synergy will be stored for further
comparison with the results from the other cell lines.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb101-1" title="1">threshold =<span class="st"> </span><span class="fl">0.7</span></a>
<a class="sourceLine" id="cb101-2" title="2"><span class="cf">for</span> (drug.comb <span class="cf">in</span> predicted.synergies) {</a>
<a class="sourceLine" id="cb101-3" title="3">  diff =<span class="st"> </span>diff.predicted.synergies.results[drug.comb, ]</a>
<a class="sourceLine" id="cb101-4" title="4">  </a>
<a class="sourceLine" id="cb101-5" title="5">  biomarkers.active =<span class="st"> </span>diff[diff <span class="op">&gt;</span><span class="st"> </span>threshold]</a>
<a class="sourceLine" id="cb101-6" title="6">  biomarkers.inhibited =<span class="st"> </span>diff[diff <span class="op">&lt;</span><span class="st"> </span><span class="op">-</span>threshold]</a>
<a class="sourceLine" id="cb101-7" title="7">  </a>
<a class="sourceLine" id="cb101-8" title="8">  <span class="kw">save_vector_to_file</span>(<span class="dt">vector =</span> biomarkers.active, <span class="dt">file =</span> <span class="kw">paste0</span>(</a>
<a class="sourceLine" id="cb101-9" title="9">    biomarkers.dir, drug.comb, <span class="st">&quot;_biomarkers_active&quot;</span>), <span class="dt">with.row.names =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb101-10" title="10">  <span class="kw">save_vector_to_file</span>(<span class="dt">vector =</span> biomarkers.inhibited, <span class="dt">file =</span> <span class="kw">paste0</span>(</a>
<a class="sourceLine" id="cb101-11" title="11">    biomarkers.dir, drug.comb, <span class="st">&quot;_biomarkers_inhibited&quot;</span>), <span class="dt">with.row.names =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb101-12" title="12">}</a></code></pre></div>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb102-1" title="1">threshold =<span class="st"> </span><span class="fl">0.7</span></a>
<a class="sourceLine" id="cb102-2" title="2"><span class="cf">for</span> (drug.comb <span class="cf">in</span> predicted.synergies) {</a>
<a class="sourceLine" id="cb102-3" title="3">  title.text =<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;Prediction of &quot;</span>, drug.comb, </a>
<a class="sourceLine" id="cb102-4" title="4">                      <span class="st">&quot; synergy: Good models vs Bad Models&quot;</span>)</a>
<a class="sourceLine" id="cb102-5" title="5">  diff =<span class="st"> </span>diff.predicted.synergies.results[drug.comb, ]</a>
<a class="sourceLine" id="cb102-6" title="6">  <span class="kw">plot_avg_state_diff_graph</span>(net, diff, <span class="dt">layout =</span> nice.layout, <span class="dt">title =</span> title.text)</a>
<a class="sourceLine" id="cb102-7" title="7">}</a></code></pre></div>
<p><img src="AGS_model_analysis_files/figure-html/Graphs:%20Good%20vs%20Bad%20models%20based%20on%20a%20specific%20synergy%20prediction-1.png" width="672" /><img src="AGS_model_analysis_files/figure-html/Graphs:%20Good%20vs%20Bad%20models%20based%20on%20a%20specific%20synergy%20prediction-2.png" width="672" /></p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb103-1" title="1"><span class="kw">print_biomarkers_per_predicted_synergy</span>(biomarkers.dir, predicted.synergies)</a></code></pre></div>
<blockquote>
<p><b>Biomarkers for BI-D1 synergy prediction</b><br/><br/><b>Active biomarkers</b><br/>3 nodes: MAPK14, RPS6KA5, DUSP1<br/><br/><b>Inhibited biomarkers</b><br/>5 nodes: FGFR1, TAB1, PTPN7, MAX, JNK<br/><br/><b>Biomarkers for PI-D1 synergy prediction</b><br/><br/><b>Active biomarkers</b><br/>0 nodes: <br/><br/><b>Inhibited biomarkers</b><br/>0 nodes: <br/><br/></p>
</blockquote>
<p>We notice that for some predicted synergies the above method identified zero
biomarkers. We will now study cases where the main goal is the <strong>better
identification and/or refinement of the biomarkers responsible for allowing the
models to predict one extra synergy from a specific synergy set</strong>. If we find
biomarkers for a predicted synergy using this strategy, we compare them to
the ones already found with the previous method and if none of them is common
we just add the new ones to the list of biomarkers for that specific synergy.
On the other hand, if the synergy-set comparison method identifies a subset of
the previously found biomarkers for a specific synergy (one common node at least),
<strong>we will only keep the later method’s biomarkers</strong> since we believe that the
synergy-set prediction based method is more accurate at identifying biomarkers
for a specific synergy because of the fewer models involved in each contrasting
category which also minimizes the total false positive synergy predictions taken
into account. Note that if the second method finds even more biomarkers than the
first, we have the option to prune the end result to only the common biomarkers
between the two methods.</p>
<p>We will focus our analysis on the predicted synergies <code>BI-D1</code> and <code>PI-D1</code>.</p>
</div>
<div id="synergy-set-prediction-based-analysis-1" class="section level3 unnumbered">
<h3>Synergy-set prediction based analysis</h3>
<div id="bi-d1-synergy" class="section level4 unnumbered">
<h4>BI-D1 synergy</h4>
<p>The first use case will contrast the models that predicted the synergy set
<code>BI-D1,PI-D1</code> vs the models that predicted the single synergy subset
<code>PI-D1</code>. This will allow us to find important nodes whose state can
influence the prediction performance of a model and make it predict the extra
<code>BI-D1</code> synergy:</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb104-1" title="1">synergy.set.str    =<span class="st"> &quot;BI-D1,PI-D1&quot;</span></a>
<a class="sourceLine" id="cb104-2" title="2">synergy.subset.str =<span class="st"> &quot;PI-D1&quot;</span></a>
<a class="sourceLine" id="cb104-3" title="3">diff.BI.D1 =<span class="st"> </span><span class="kw">get_avg_activity_diff_based_on_synergy_set_cmp</span>(</a>
<a class="sourceLine" id="cb104-4" title="4">  synergy.set.str, synergy.subset.str, model.predictions, models.stable.state)</a></code></pre></div>
<p>We now visualize the average state differences:</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb105-1" title="1">title.text =<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;Good models (&quot;</span>, synergy.set.str,</a>
<a class="sourceLine" id="cb105-2" title="2">                    <span class="st">&quot;) vs Bad Models (&quot;</span>, synergy.subset.str, <span class="st">&quot;)&quot;</span>)</a>
<a class="sourceLine" id="cb105-3" title="3"><span class="kw">plot_avg_state_diff_graph</span>(net, diff.BI.D1, <span class="dt">layout =</span> nice.layout, <span class="dt">title =</span> title.text)</a></code></pre></div>
<p><img src="AGS_model_analysis_files/figure-html/Graphs:%20Good%20vs%20Bad%20models%20based%20on%20different%20synergy%20set%20prediction%20(BI-D1)-1.png" width="672" /></p>
<p>and report the active biomarkers found:</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb106-1" title="1">biomarkers.BI.D1.active =<span class="st"> </span>diff.BI.D1[diff.BI.D1 <span class="op">&gt;</span><span class="st"> </span>threshold]</a>
<a class="sourceLine" id="cb106-2" title="2"><span class="kw">pretty_print_vector_names</span>(biomarkers.BI.D1.active)</a></code></pre></div>
<blockquote>
<p>3 nodes: MAPK14, RPS6KA5, DUSP1</p>
</blockquote>
<p>Note that with the previous method of classifying the models (those that
predict the <code>BI-D1</code> synergy and those that don’t), we identified the same 3
active biomarkers. The inhibited biomarkers are the same ones also, with the
addition of 2 more nodes:</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb107-1" title="1">biomarkers.BI.D1.inhibited =<span class="st"> </span>diff.BI.D1[diff.BI.D1 <span class="op">&lt;</span><span class="st"> </span><span class="op">-</span>threshold]</a>
<a class="sourceLine" id="cb107-2" title="2"><span class="kw">pretty_print_vector_names</span>(biomarkers.BI.D1.inhibited)</a></code></pre></div>
<blockquote>
<p>7 nodes: FGFR1, TAB1, CASP3, EGFR, PTPN7, MAX, JNK</p>
</blockquote>
<p>Lastly, we update the biomarkers for this specific synergy in the respective
file:</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb108-1" title="1">drug.comb =<span class="st"> &quot;BI-D1&quot;</span></a>
<a class="sourceLine" id="cb108-2" title="2"><span class="kw">update_biomarker_files</span>(biomarkers.dir, drug.comb, </a>
<a class="sourceLine" id="cb108-3" title="3">                       biomarkers.BI.D1.active, biomarkers.BI.D1.inhibited)</a></code></pre></div>
</div>
<div id="pi-d1-synergy" class="section level4 unnumbered">
<h4>PI-D1 synergy</h4>
<p>The second use case will contrast the models that predicted the synergy set
<code>BI-D1,PI-D1</code> vs the models that predicted the single synergy
<code>BI-D1</code>. This will allow us to find important nodes whose state can
influence the prediction performance of a model and make it predict the extra
<code>PI-D1</code> synergy:</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb109-1" title="1">synergy.set.str    =<span class="st"> &quot;BI-D1,PI-D1&quot;</span></a>
<a class="sourceLine" id="cb109-2" title="2">synergy.subset.str =<span class="st"> &quot;BI-D1&quot;</span></a>
<a class="sourceLine" id="cb109-3" title="3">diff.PI.D1 =<span class="st"> </span><span class="kw">get_avg_activity_diff_based_on_synergy_set_cmp</span>(</a>
<a class="sourceLine" id="cb109-4" title="4">  synergy.set.str, synergy.subset.str, model.predictions, models.stable.state)</a></code></pre></div>
<p>We now visualize the average state differences:</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb110-1" title="1">title.text =<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;Good models (&quot;</span>, synergy.set.str,</a>
<a class="sourceLine" id="cb110-2" title="2">                    <span class="st">&quot;) vs Bad Models (&quot;</span>, synergy.subset.str, <span class="st">&quot;)&quot;</span>)</a>
<a class="sourceLine" id="cb110-3" title="3"><span class="kw">plot_avg_state_diff_graph</span>(net, diff.PI.D1, <span class="dt">layout =</span> nice.layout, <span class="dt">title =</span> title.text)</a></code></pre></div>
<p><img src="AGS_model_analysis_files/figure-html/Graphs:%20Good%20vs%20Bad%20models%20based%20on%20different%20synergy%20set%20prediction%20(PI-D1)-1.png" width="672" /></p>
<p>Sadly, no biomarkers were found at the <span class="math inline">\(0.7\)</span> threshold in either active or
inhibited states:</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb111-1" title="1">biomarkers.PI.D1.active =<span class="st"> </span>diff.PI.D1[diff.PI.D1 <span class="op">&gt;</span><span class="st"> </span>threshold]</a>
<a class="sourceLine" id="cb111-2" title="2"><span class="kw">pretty_print_vector_names</span>(biomarkers.PI.D1.active)</a></code></pre></div>
<blockquote>
<p>0 nodes:</p>
</blockquote>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb112-1" title="1">biomarkers.PI.D1.inhibited =<span class="st"> </span>diff.PI.D1[diff.PI.D1 <span class="op">&lt;</span><span class="st"> </span><span class="op">-</span>threshold]</a>
<a class="sourceLine" id="cb112-2" title="2"><span class="kw">pretty_print_vector_names</span>(biomarkers.PI.D1.inhibited)</a></code></pre></div>
<blockquote>
<p>0 nodes:</p>
</blockquote>
</div>
</div>
<div id="biomarker-results-1" class="section level3 unnumbered">
<h3>Biomarker results</h3>
<p>In this section, we will compare the <strong>biomarkers found per predicted synergy</strong>
for this particular cell line as well as the <strong>performance biomarkers</strong> (notated
as <strong>PERF</strong> in the heatmap below) which were found using the common results from
the TP and MCC classification-based model analysis:</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb113-1" title="1"><span class="co"># Biomarkers from sections:</span></a>
<a class="sourceLine" id="cb113-2" title="2"><span class="co"># `Synergy-prediction based analysis`, `Synergy-set prediction based analysis`</span></a>
<a class="sourceLine" id="cb113-3" title="3">biomarkers.synergy.res =</a>
<a class="sourceLine" id="cb113-4" title="4"><span class="st">  </span><span class="kw">get_synergy_biomarkers_from_dir</span>(predicted.synergies, biomarkers.dir, models.dir)</a>
<a class="sourceLine" id="cb113-5" title="5"></a>
<a class="sourceLine" id="cb113-6" title="6"><span class="co"># store biomarkers in one file</span></a>
<a class="sourceLine" id="cb113-7" title="7"><span class="kw">save_df_to_file</span>(biomarkers.synergy.res, <span class="dt">file =</span></a>
<a class="sourceLine" id="cb113-8" title="8">                <span class="kw">paste0</span>(biomarkers.dir, <span class="st">&quot;biomarkers_per_synergy&quot;</span>))</a>
<a class="sourceLine" id="cb113-9" title="9"></a>
<a class="sourceLine" id="cb113-10" title="10"><span class="co"># Biomarkers from section:</span></a>
<a class="sourceLine" id="cb113-11" title="11"><span class="co"># `Performance-related biomarkers`</span></a>
<a class="sourceLine" id="cb113-12" title="12">biomarkers.res =<span class="st"> </span><span class="kw">add_row_to_biomarkers_df</span>(biomarkers.synergy.res, </a>
<a class="sourceLine" id="cb113-13" title="13">                                          biomarkers.perf.active, </a>
<a class="sourceLine" id="cb113-14" title="14">                                          biomarkers.perf.inhibited)</a>
<a class="sourceLine" id="cb113-15" title="15"></a>
<a class="sourceLine" id="cb113-16" title="16"><span class="co"># prune nodes which are not found as biomarkers for any predicted synergy or</span></a>
<a class="sourceLine" id="cb113-17" title="17"><span class="co"># for better model performance</span></a>
<a class="sourceLine" id="cb113-18" title="18">biomarkers.res =<span class="st"> </span><span class="kw">prune_columns_from_df</span>(biomarkers.res, <span class="dt">value =</span> <span class="dv">0</span>)</a></code></pre></div>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb114-1" title="1"><span class="co"># define a coloring</span></a>
<a class="sourceLine" id="cb114-2" title="2">biomarkers.col.fun =<span class="st"> </span><span class="kw">colorRamp2</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="kw">c</span>(<span class="st">&quot;tomato&quot;</span>, <span class="st">&quot;grey&quot;</span>, <span class="st">&quot;gold&quot;</span>))</a>
<a class="sourceLine" id="cb114-3" title="3"></a>
<a class="sourceLine" id="cb114-4" title="4">biomarkers.heatmap =<span class="st"> </span></a>
<a class="sourceLine" id="cb114-5" title="5"><span class="st">    </span><span class="kw">Heatmap</span>(<span class="dt">matrix =</span> <span class="kw">as.matrix</span>(biomarkers.res), <span class="dt">col =</span> biomarkers.col.fun, </a>
<a class="sourceLine" id="cb114-6" title="6">            <span class="dt">column_title =</span> <span class="kw">paste0</span>(<span class="st">&quot;Biomarker results (&quot;</span>, cell.line, <span class="st">&quot;)&quot;</span>),</a>
<a class="sourceLine" id="cb114-7" title="7">            <span class="dt">column_title_gp =</span> <span class="kw">gpar</span>(<span class="dt">fontsize =</span> <span class="dv">20</span>, <span class="dt">fontface =</span> <span class="st">&quot;bold&quot;</span>),</a>
<a class="sourceLine" id="cb114-8" title="8">            <span class="dt">row_title =</span> <span class="st">&quot;Predicted synergies&quot;</span>,</a>
<a class="sourceLine" id="cb114-9" title="9">            <span class="dt">row_order =</span> <span class="kw">nrow</span>(biomarkers.res)<span class="op">:</span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb114-10" title="10">            <span class="dt">column_dend_height =</span> <span class="kw">unit</span>(<span class="fl">0.5</span>, <span class="st">&quot;inches&quot;</span>), </a>
<a class="sourceLine" id="cb114-11" title="11">            <span class="dt">rect_gp =</span> <span class="kw">gpar</span>(<span class="dt">col =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">lwd =</span> <span class="fl">0.3</span>),</a>
<a class="sourceLine" id="cb114-12" title="12">            <span class="dt">column_names_gp =</span> <span class="kw">gpar</span>(<span class="dt">fontsize =</span> <span class="dv">10</span>), <span class="dt">row_names_side =</span> <span class="st">&quot;left&quot;</span>,</a>
<a class="sourceLine" id="cb114-13" title="13">            <span class="dt">heatmap_legend_param =</span> <span class="kw">list</span>(<span class="dt">at =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="dt">title =</span> <span class="st">&quot;Activity State&quot;</span>,</a>
<a class="sourceLine" id="cb114-14" title="14">              <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Inhibited&quot;</span>, <span class="st">&quot;Active&quot;</span>), <span class="dt">color_bar =</span> <span class="st">&quot;discrete&quot;</span>,</a>
<a class="sourceLine" id="cb114-15" title="15">              <span class="dt">title_position =</span> <span class="st">&quot;leftcenter&quot;</span>, <span class="dt">direction =</span> <span class="st">&quot;horizontal&quot;</span>, <span class="dt">ncol =</span> <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb114-16" title="16"></a>
<a class="sourceLine" id="cb114-17" title="17"><span class="kw">draw</span>(biomarkers.heatmap, <span class="dt">heatmap_legend_side =</span> <span class="st">&quot;bottom&quot;</span>)</a></code></pre></div>
<p><img src="AGS_model_analysis_files/figure-html/Biomarkers%20heatmap-1.png" width="2100" /></p>
<p>So, in general we observe that:</p>
<ul>
<li>A total of 10 nodes were found as biomarkers (for at
least one synergy)</li>
<li>We couldn’t indentify any biomarkers at the <span class="math inline">\(0.7\)</span> threshold for the <code>PI-D1</code>
synergy, while for the <code>BI-D1</code> synergy we found 10 biomarkers. Usually we wouldn’t
expect too many biomarkers that are directly related to the prediction of a
specific synergy. The abudance of (false positive) biomarkers for some synergies
(e.g. <code>BI-D1</code>) relates to the model classification method used, which does not
incorporate in its internal logic that the prediction of other synergies than the
ones used for the grouping itself can affect the biomarker results obtained from
it</li>
<li>The performance-related biomarkers (PERF) were exactly the same ones found for
the prediction of the <code>BI-D1</code> synergy</li>
</ul>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="a498-model-analysis.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="session-info.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
